<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="SetUID Attack Lab - SeedLabs" /><meta property="og:locale" content="en" /><meta name="description" content="Set-UID is an important security mechanism in unix systems. When a Set-UID program is run, the executing program assumes the owner’s privileges irrespective of the user running the program. The tasks are exploration based and are to be done on linux systems. The prebuilt VM called seedubuntu comes installed with all the required software. Various scenarios are duplicated using Set-UID programs. The problems with each are listed." /><meta property="og:description" content="Set-UID is an important security mechanism in unix systems. When a Set-UID program is run, the executing program assumes the owner’s privileges irrespective of the user running the program. The tasks are exploration based and are to be done on linux systems. The prebuilt VM called seedubuntu comes installed with all the required software. Various scenarios are duplicated using Set-UID programs. The problems with each are listed." /><link rel="canonical" href="https://tanishq.page/blog/posts/setuid-attack-lab/" /><meta property="og:url" content="https://tanishq.page/blog/posts/setuid-attack-lab/" /><meta property="og:site_name" content="Tanishq Rupaal" /><meta property="og:image" content="https://tanishq.page/blog/assets/img/covers/seedlabs-cover.jpg" /><meta property="og:image:alt" content="Seed Labs Artwork" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-06-01T03:00:00-04:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://tanishq.page/blog/assets/img/covers/seedlabs-cover.jpg" /><meta name="twitter:image:alt" content="Seed Labs Artwork" /><meta property="twitter:title" content="SetUID Attack Lab - SeedLabs" /><meta name="twitter:site" content="@etheriosking" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2020-06-01T03:00:00-04:00","datePublished":"2020-06-01T03:00:00-04:00","description":"Set-UID is an important security mechanism in unix systems. When a Set-UID program is run, the executing program assumes the owner’s privileges irrespective of the user running the program. The tasks are exploration based and are to be done on linux systems. The prebuilt VM called seedubuntu comes installed with all the required software. Various scenarios are duplicated using Set-UID programs. The problems with each are listed.","headline":"SetUID Attack Lab - SeedLabs","image":{"alt":"Seed Labs Artwork","url":"https://tanishq.page/blog/assets/img/covers/seedlabs-cover.jpg","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://tanishq.page/blog/posts/setuid-attack-lab/"},"url":"https://tanishq.page/blog/posts/setuid-attack-lab/"}</script><title>SetUID Attack Lab - SeedLabs | Tanishq Rupaal</title><link rel="apple-touch-icon" sizes="180x180" href="/blog/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/blog/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/blog/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/blog/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/blog/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Tanishq Rupaal"><meta name="application-name" content="Tanishq Rupaal"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/blog/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/blog/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/blog/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script> <script defer src="/blog/assets/js/dist/post.min.js"></script> <script defer src="/blog/app.min.js?baseurl=/blog&register=true" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-B88HEPZBVJ"></script> <script> document.addEventListener('DOMContentLoaded', () => { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-B88HEPZBVJ'); }); </script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/blog/" id="avatar" class="rounded-circle"><img src="/blog/assets/Abstract.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/blog/">Tanishq Rupaal</a><p class="site-subtitle fst-italic mb-0">Cybersecurity Professional</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/blog/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/blog/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/blog/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/blog/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/blog/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/tanq16" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/etheriosking" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['dragonking47','proton.me'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://linkedin.com/in/tanishqrupaal" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/blog/">Home</a> </span> <span>SetUID Attack Lab - SeedLabs</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>SetUID Attack Lab - SeedLabs</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1590994800" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jun 1, 2020 </time> </span><div class="mt-3 mb-3"> <a href="/blog/assets/img/covers/seedlabs-cover.jpg" class="popup img-link preview-img shimmer"><img src="/blog/assets/img/covers/seedlabs-cover.jpg" alt="Seed Labs Artwork" width="1200" height="630" loading="lazy"></a><figcaption class="text-center pt-2 pb-2">Seed Labs Artwork</figcaption></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/etheriosking">Tanishq Rupaal</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="2544 words" > <em>14 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">SetUID Attack Lab - SeedLabs</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">Contents</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">SetUID Attack Lab - SeedLabs</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"><p>Set-UID is an important security mechanism in unix systems. When a Set-UID program is run, the executing program assumes the owner’s privileges irrespective of the user running the program. The tasks are exploration based and are to be done on linux systems. The prebuilt VM called <code class="language-plaintext highlighter-rouge">seedubuntu</code> comes installed with all the required software. Various scenarios are duplicated using Set-UID programs. The problems with each are listed.</p><h2 id="task-1--familiarizing-with-chsh-su-sudo"><span class="me-2">Task 1 : Familiarizing with <code class="language-plaintext highlighter-rouge">chsh</code>, <code class="language-plaintext highlighter-rouge">su</code>, <code class="language-plaintext highlighter-rouge">sudo</code></span><a href="#task-1--familiarizing-with-chsh-su-sudo" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ol><li><code class="language-plaintext highlighter-rouge">chsh</code> - This command helps change the current user’s login shell to another desired one. It accepts any executable as long as it is listed in <code class="language-plaintext highlighter-rouge">/etc/shells</code> file.<li><code class="language-plaintext highlighter-rouge">su</code> - This command is to switch user to another user specified one. It can also be used to do the job of sudo using <code class="language-plaintext highlighter-rouge">su -c</code>.<li><code class="language-plaintext highlighter-rouge">sudo</code> - This command is used to specify that the following command is to be executed with the permissions of the super user (super user do). If <code class="language-plaintext highlighter-rouge">root</code> has given the super user access rights (the ability to elevate current access rights as a normal user to super user which can be equivalent to root), the user can use sudo to elevate the permissions.</ol><p>NOTE - The sudo and su command combination can be used by a user with access rights to become the root user without knowing the password of the <code class="language-plaintext highlighter-rouge">root</code> user. <code class="language-plaintext highlighter-rouge">sudo su</code> is the command that changes to the <code class="language-plaintext highlighter-rouge">root</code> user if the current user has access rights.</p><p>The above commands need to be Set-UID because the actions done by all the above commands are to be executed only with the access rights of <code class="language-plaintext highlighter-rouge">root</code>. If any normal user is to use these commands, he would not be able to get the results as he does not have sufficient rights to let the execution carry out the actions. Therefore, these executables are made Set-UID by the <code class="language-plaintext highlighter-rouge">root</code>, so when a user wants to execute these commands, his access rights will be elevated to that of the owner (i.e., <code class="language-plaintext highlighter-rouge">root</code>), and as a result he will be able to let the executable carry out the actions and see the results.</p><h2 id="task-2--run-set-uid-shell-programs-in-linux"><span class="me-2">Task 2 : Run Set-UID shell programs in linux</span><a href="#task-2--run-set-uid-shell-programs-in-linux" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The permissions parameters as seen after ls command have more 3 bits to the left of the one that specifies if the file in question is a file or a link or a directory. The 1st of these 3 bits signifies if the program is Set-UID or not. This makes the 3 bits 100 i.e., 4. Therefore, to make an executable Set-UID, the command is <code class="language-plaintext highlighter-rouge">chmod 4&lt;&gt;&lt;&gt;&lt;&gt; &lt;file&gt;</code>, where <code class="language-plaintext highlighter-rouge">&lt;&gt;</code> are general permissions. After an executable has been made Set-UID, the <code class="language-plaintext highlighter-rouge">x</code> bit that signifies the executable rights of it, becomes <code class="language-plaintext highlighter-rouge">s</code>. The task is to login as root and make a copy of a shell program called <code class="language-plaintext highlighter-rouge">zsh</code> to the tmp folder using command <code class="language-plaintext highlighter-rouge"># cp /bin/zsh /tmp/testshell</code>. This will create the program <code class="language-plaintext highlighter-rouge">testshell</code> which is a copy of zsh. We make this a Set-UID to root executable by command <code class="language-plaintext highlighter-rouge">chmod 4755 /tmp/testshell</code>. Now we create another user <code class="language-plaintext highlighter-rouge">BOB</code> and do not give him any explicit rights. Using this new user we navigate to <code class="language-plaintext highlighter-rouge">/tmp</code>. Here on checking the output of <code class="language-plaintext highlighter-rouge">$whoami</code>, we see <code class="language-plaintext highlighter-rouge">BOB</code>. Now we can execute the <code class="language-plaintext highlighter-rouge">testshell</code>, upon which, the output of <code class="language-plaintext highlighter-rouge">whoami</code> changes to <code class="language-plaintext highlighter-rouge">root</code>. This happens because the <code class="language-plaintext highlighter-rouge">testshell</code> program is a Set-UID to root executable. Now even a user user who does not have high level of access rights can do anything in the system as he has become the root.</p><p>This problem is very grave and exists in the <code class="language-plaintext highlighter-rouge">zsh</code> shell program. The current default shell in linux is <code class="language-plaintext highlighter-rouge">bash</code>. On repeating the above task again with <code class="language-plaintext highlighter-rouge">/bin/bash</code> instead of using zsh, we see that upon executing <code class="language-plaintext highlighter-rouge">testshell</code>, now the output of <code class="language-plaintext highlighter-rouge">whoami</code> gives only <code class="language-plaintext highlighter-rouge">BOB</code>. Therefore, <code class="language-plaintext highlighter-rouge">bash</code> has protection against this flaw of Set-UID. Zsh on the other hand is not immune to this issue.</p><h2 id="task-3--setup-for-remaining-tasks"><span class="me-2">Task 3 : Setup for remaining tasks</span><a href="#task-3--setup-for-remaining-tasks" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>As seen, <code class="language-plaintext highlighter-rouge">bash</code> does not share the Set-UID exploit vulnerability with <code class="language-plaintext highlighter-rouge">zsh</code>. Therefore, the remaining tasks will be explored on zsh itself. For this we create a symbolic link to zsh and remove the link before it if it is a link to bash. The series of commands are →</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>$ sudo su
  Enter password:
# cd /bin
# rm sh
# ln -s zsh sh
</pre></table></code></div></div><p>This has created a symbolic link to zsh as <code class="language-plaintext highlighter-rouge">/bin/sh</code>.</p><h2 id="task-4--path-variable-and-system-vulnerability"><span class="me-2">Task 4 : PATH variable and <code class="language-plaintext highlighter-rouge">system()</code> vulnerability</span><a href="#task-4--path-variable-and-system-vulnerability" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The <code class="language-plaintext highlighter-rouge">system()</code> command is one that executes the command by the command name that is passed into itself treated as a function. The way <code class="language-plaintext highlighter-rouge">system()</code> does this is by creating or calling the shell program <code class="language-plaintext highlighter-rouge">/bin/sh</code>. To exploit the vulnerability, consider the situation where the root user has created a program in c using a <code class="language-plaintext highlighter-rouge">system()</code> command to emulate the <code class="language-plaintext highlighter-rouge">ls</code> command. This program is owned by root and is compiled as test and made a Set-UID to root executable.</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="cp">#include</span><span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span><span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">system</span><span class="p">(</span><span class="s">"ls"</span><span class="p">);</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>The <code class="language-plaintext highlighter-rouge">PATH</code> variable is that which tells the system where commands are located. Since commands are basically just executables, to run them we need to specify a path like <code class="language-plaintext highlighter-rouge">/&lt;directory&gt;/&lt;command&gt;</code>. Giving the <code class="language-plaintext highlighter-rouge">PATH</code> variable ensures that to run the command, the entire path need not be given. When the <code class="language-plaintext highlighter-rouge">&lt;directory&gt;</code> part of the command is added in the <code class="language-plaintext highlighter-rouge">PATH</code> variable, any command we type on the terminal is searched in the directories listed in the <code class="language-plaintext highlighter-rouge">PATH</code> variable. If the command is present is one of these mentioned directories, it gets executed. As a result instead of typing <code class="language-plaintext highlighter-rouge">/&lt;directory&gt;/&lt;command&gt;</code>, we just type <code class="language-plaintext highlighter-rouge">&lt;command&gt;</code>. This is compiled using <code class="language-plaintext highlighter-rouge">$gcc -o test test.c</code>. Now basically, any user who runs the executable <code class="language-plaintext highlighter-rouge">test</code> will actually be executing <code class="language-plaintext highlighter-rouge">ls</code> in his current working directory with root permissions. The exploit is to set the <code class="language-plaintext highlighter-rouge">PATH</code> environment variable to just the current directory and then making a script called <code class="language-plaintext highlighter-rouge">ls</code> which calls a shell. <code class="language-plaintext highlighter-rouge">PATH</code> environment variable is the one that stores the paths of all the executable so that users need not specify the exact location of that command from the <code class="language-plaintext highlighter-rouge">/</code> directory or the present working directory to execute that command. Consider the user <code class="language-plaintext highlighter-rouge">BOB</code>, writes a script -</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>#!/bin/sh
/bin/sh
</pre></table></code></div></div><p>This script is named <code class="language-plaintext highlighter-rouge">ls</code> and is made executable by <code class="language-plaintext highlighter-rouge">BOB</code>. Now <code class="language-plaintext highlighter-rouge">BOB</code>, sets the PATH to the current directory by using <code class="language-plaintext highlighter-rouge">$ export PATH=.</code>. Now he runs the Set-UID executable test and gets a shell. Upon using <code class="language-plaintext highlighter-rouge">whoami</code>, he sees that he is actually root.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>$ ./test
# /usr/bin/whoami
root
#
</pre></table></code></div></div><p>On executing test, it actually calls ls on a shell. Since the PATH variable is set to the current directory, the <code class="language-plaintext highlighter-rouge">system()</code> command looks for <code class="language-plaintext highlighter-rouge">ls</code> only in the current directory where it finds the script which basically calls for the shell <code class="language-plaintext highlighter-rouge">/bin/sh</code>. Since the program is a Set-UID program, the shell called is the one with the access rights of the owner i.e., root. Since PATH is changed, the user needs to call all commands by giving absolute paths. But, he got the root shell. A similar exploit can be done by adding <code class="language-plaintext highlighter-rouge">/</code> to <code class="language-plaintext highlighter-rouge">IFS</code> environment variable.</p><p>Now, the same task is repeated but this time, <code class="language-plaintext highlighter-rouge">/bin/sh</code> is changed to point to <code class="language-plaintext highlighter-rouge">/bin/bash</code>. Zsh had the vulnerability, but bash on executing the same command, does give the shell but it has the same access rights as the user who called the <code class="language-plaintext highlighter-rouge">test</code> executable. Hence, the exploit fails.</p><h2 id="task-5--extension-of-task-4-system-vs-execve"><span class="me-2">Task 5 : Extension of task 4, <code class="language-plaintext highlighter-rouge">system()</code> vs <code class="language-plaintext highlighter-rouge">execve()</code></span><a href="#task-5--extension-of-task-4-system-vs-execve" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Background: <code class="language-plaintext highlighter-rouge">BOB</code> works for an auditing agency, and he needs to investigate a company for a suspected fraud. For the investigation purpose, <code class="language-plaintext highlighter-rouge">BOB</code> needs to be able to read all the files in the company’s Unix system; on the other hand, to protect the integrity of the system, Bob should not be able to modify any file. To achieve this goal, <code class="language-plaintext highlighter-rouge">Vince</code>, the superuser of the system, wrote a special set-root-uid program, and then gave the executable permission to <code class="language-plaintext highlighter-rouge">BOB</code>. This program requires <code class="language-plaintext highlighter-rouge">BOB</code> to type a file name at the command line, and then it will run <code class="language-plaintext highlighter-rouge">/bin/cat</code> to display the specified file. Since the program is running as a root, it can display any file <code class="language-plaintext highlighter-rouge">BOB</code> specifies. However, since the program has no write operations, <code class="language-plaintext highlighter-rouge">Vince</code> is very sure that <code class="language-plaintext highlighter-rouge">BOB</code> cannot use this special program to modify any file.</p><p>The code is as follows →</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="cp">#include</span><span class="cpf">&lt;string.h&gt;</span><span class="cp">
#include</span><span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span><span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
  <span class="kt">char</span><span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
  <span class="k">if</span><span class="p">(</span><span class="n">argc</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Please type a file name.</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s">"/bin/cat"</span><span class="p">;</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">q</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">if</span><span class="p">(</span><span class="n">q</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="kt">char</span><span class="o">*</span> <span class="n">command</span> <span class="o">=</span> <span class="n">malloc</span><span class="p">(</span><span class="n">strlen</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">strlen</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="mi">2</span><span class="p">);</span>
    <span class="n">sprintf</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="s">"%s %s"</span><span class="p">,</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
    <span class="n">system</span><span class="p">(</span><span class="n">command</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="nf">execve</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Here, <code class="language-plaintext highlighter-rouge">q</code> is the variable control for us to shift between <code class="language-plaintext highlighter-rouge">system()</code> and <code class="language-plaintext highlighter-rouge">execve()</code> commands.</p><p>Initially, <code class="language-plaintext highlighter-rouge">q = 0</code>. Therefore, <code class="language-plaintext highlighter-rouge">system()</code> will get executed. This is an extension to the the exploit on Set-UID programs with <code class="language-plaintext highlighter-rouge">system()</code> command. Here, <code class="language-plaintext highlighter-rouge">BOB</code> can exploit Set-UID vulnerability to actually modify files (which is contrary to what he should be able to do according to <code class="language-plaintext highlighter-rouge">Vince</code>). To do this, <code class="language-plaintext highlighter-rouge">BOB</code> basically makes use of special characters used in shell scripting to modify files. Consider a file called <code class="language-plaintext highlighter-rouge">test.txt</code> which is owned by root. <code class="language-plaintext highlighter-rouge">BOB</code> can read the contents of the file by using the above program’s executable which is a Set-UID to root executable (calls <code class="language-plaintext highlighter-rouge">/bin/cat</code> with root permissions). Now <code class="language-plaintext highlighter-rouge">BOB</code> can actually exploit the program by making use of <code class="language-plaintext highlighter-rouge">&amp;&amp;</code> and <code class="language-plaintext highlighter-rouge">;</code> operators. He can execute something like →</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>$ ./test "test.txt;mv test.txt ruty.txt"
&lt;contents of text.txt&gt;
</pre></table></code></div></div><p>After this operation, <code class="language-plaintext highlighter-rouge">test.txt</code> would have been renamed to <code class="language-plaintext highlighter-rouge">ruty.txt</code>. The same can also be accomplished using the <code class="language-plaintext highlighter-rouge">&amp;&amp;</code> operator as well as these have special meaning in shell programs. Another way to check the permissions is</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>$ ./test "test.txt &amp;&amp; whoami"
&lt;contents of text.txt&gt;
root
</pre></table></code></div></div><p>Since the <code class="language-plaintext highlighter-rouge">system()</code> command passes the given parameters onto a shell, the <code class="language-plaintext highlighter-rouge">whoami</code> gets executed with the permissions of the owner of the program’s Set-UID to root executable. Hence, we get root.</p><p>One possible way to save from this vulnerability can be to edit the program to include a regular expression match to rule out special characters like <code class="language-plaintext highlighter-rouge">$ &amp; ;</code>.</p><p>Now, when we make the value of q equal to 1 in the c file <code class="language-plaintext highlighter-rouge">q = 1</code>, the program basically executes <code class="language-plaintext highlighter-rouge">execve()</code>. This is different from <code class="language-plaintext highlighter-rouge">system()</code> in the sense that it does not pass the arguments to a shell. It simply executes the program that is passed to it as the first argument. The program must be a binary executable or a script start with shebang directive. The output using <code class="language-plaintext highlighter-rouge">execve()</code> is →</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>$ ./test "test.txt;whoami"
/bin/cat: test.txt;whoami : No such file or directory
</pre></table></code></div></div><p>Therefore, as seen <code class="language-plaintext highlighter-rouge">system()</code> is very dangerous compared to <code class="language-plaintext highlighter-rouge">execve()</code> for Set-UID programs.</p><h2 id="task-6--the-ld_preload-environment-variable"><span class="me-2">Task 6 : The <code class="language-plaintext highlighter-rouge">LD_PRELOAD</code> environment variable</span><a href="#task-6--the-ld_preload-environment-variable" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>For normal executions of programs, the linux dynamic loader finds and loads the shared libraries needed by the program. The shared libraries are loaded in whatever order the loader needs them in order to resolve symbols. An environmental variable called <code class="language-plaintext highlighter-rouge">LD_PRELOAD</code> contains the paths to shared libraries or shared objects. The loader will load these before any other library, even the C runtime library. This is called preloading a library. When a library is preloaded, the functions defined in it are used before the functions with the same name in other libraries that are loaded later. This enables library functions to be overwritten. As a result we can modify program actions without the need of recompilation. Eg - we write a library to define malloc and free. After loading this into the <code class="language-plaintext highlighter-rouge">LD_PRELOAD</code>, we can use the new definitions as the library will be preloaded. It is exported in the same way <code class="language-plaintext highlighter-rouge">PATH</code> variable is exported. This is used many times for Set-UID attacks. There is a mechanism which prevents the attacks which is to be explored in this task.</p><p>This task is about making a dynamic link library which will override the <code class="language-plaintext highlighter-rouge">sleep()</code> function. This will be used for Set-UID attack, and the conditions for which the loader will ignore the <code class="language-plaintext highlighter-rouge">LD_PRELOAD</code> so as to prevent the Set-UID attacks will be explored. The task has 4 different cases for this exploration.</p><p>The dll we make is →</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="cp">#include</span><span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span><span class="kt">void</span> <span class="nf">sleep</span><span class="p">(</span><span class="kt">int</span> <span class="n">s</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"I am not sleeping</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>We can compile this using →</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ </span>gcc <span class="nt">-fPIC</span> <span class="nt">-g</span> <span class="nt">-c</span> mylib.c
<span class="nv">$ </span>gcc <span class="nt">-shared</span> <span class="nt">-Wl</span>,-soname,libmylib.so.1 <span class="nt">-o</span> libmylib.so.1.0.1 mylib.o <span class="nt">-lc</span>
</pre></table></code></div></div><p>The <code class="language-plaintext highlighter-rouge">LD_PRELOAD</code> can be set using →</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">export </span><span class="nv">LD_PRELOAD</span><span class="o">=</span>./libmylib.so.1.0.1
</pre></table></code></div></div><p>Now we create a program to call <code class="language-plaintext highlighter-rouge">sleep()</code> →</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>The 4 cases are →</p><ol><li>Run normal program by normal user → Made, compiled and run by normal user, the <code class="language-plaintext highlighter-rouge">sleep()</code> function does get overwritten. We get the “I am not sleeping message”.<li>Run Set-UID to root program by normal user → <code class="language-plaintext highlighter-rouge">myprog.c</code> compiled by root and executable is Set-UID, the <code class="language-plaintext highlighter-rouge">sleep()</code> function is not overwritten. There is a wait for 1 second and then prompt returns.<li>Run Set-UID root program by root user → <code class="language-plaintext highlighter-rouge">myprog.c</code> compiled by root and executable is Set-UID, the <code class="language-plaintext highlighter-rouge">sleep()</code> function is not overwritten. There is a wait for 1 second and then prompt returns. But if the <code class="language-plaintext highlighter-rouge">LD_PRELOAD</code> is also exported by the root user, then the <code class="language-plaintext highlighter-rouge">sleep()</code> function gets overwritten and we see the “I am not sleeping” message.<li>Run Set-UID user program by other non root user → In this case too, <code class="language-plaintext highlighter-rouge">myprog.c</code> compiled by non-root and executable is Set-UID and <code class="language-plaintext highlighter-rouge">myprog</code> is called by another non-root user, the <code class="language-plaintext highlighter-rouge">sleep()</code> function is not overwritten. There is a wait for 1 second and then prompt returns.</ol><p>The result is hence that the linker ignores the <code class="language-plaintext highlighter-rouge">LD_PRELOAD</code> environment variable if the real UID of the user id different than that of the same user’s effective UID. This is a prevention mechanism against the Set-UID attacks.</p><h2 id="task-7--relinquishing-privileges-and-cleanup"><span class="me-2">Task 7 : Relinquishing privileges and cleanup</span><a href="#task-7--relinquishing-privileges-and-cleanup" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Too be secure, the Set-UID programs call <code class="language-plaintext highlighter-rouge">setuid()</code> system call to permanently relinquish their rot privileges. Sometimes, this is not enough.</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;sys/types.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;sys/stat.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;fcntl.h&gt;</span><span class="cp">
</span>
<span class="kt">void</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">fd</span><span class="p">;</span>
  <span class="n">fd</span> <span class="o">=</span> <span class="n">open</span><span class="p">(</span><span class="s">"etc/zzz"</span><span class="p">,</span> <span class="n">O_RDWR</span> <span class="o">|</span> <span class="n">O_APPEND</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">fd</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"cannot open it </span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
  <span class="n">setuid</span><span class="p">(</span><span class="n">getuid</span><span class="p">());</span>
  <span class="k">if</span><span class="p">(</span><span class="n">fork</span><span class="p">())</span>
  <span class="p">{</span>
    <span class="n">close</span><span class="p">(</span><span class="n">fd</span><span class="p">);</span>
    <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <span class="n">write</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="s">"malicious data</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="mi">15</span><span class="p">);</span>
    <span class="n">close</span><span class="p">(</span><span class="n">fd</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>We compile this as root and make the executable Set-UID to root. <code class="language-plaintext highlighter-rouge">setuid()</code> sets the effective user id of the current process. If the effective UID of the caller is root, the real UID and saved set-user-id are also set. We create a file <code class="language-plaintext highlighter-rouge">/etc/zzz</code> which is owned by root and the permissions are 0644. Now any other user should not be able to write to the file after the <code class="language-plaintext highlighter-rouge">setuid()</code> function is called and all the user privileges while the Set-UID was being executed is reset. On making the Set-UID to root executable and executing it by a different user, the result is that the file actually gets modified. The malicious data is actually appended to the file. Despite the presence of a function to drop all privileges, the write succeeded. This is so because the function was not placed properly. The <code class="language-plaintext highlighter-rouge">setuid()</code> was called only after the file was opened. To prevent other users from accessing files this way, the function should be declared before the opening of the file. This way the real UID and effective UID will be changed from root before the file is opened. If the function is called after the opening of the file, the privileges are dropped, but the program had already opened the file in write (append) mode as <code class="language-plaintext highlighter-rouge">root</code> itself.</p><hr /><blockquote><p>The above is a documentation of a lab experiment by the name Set-Uid attack lab from publicly available seed labs by Syracuse University. <a href="http://www.cis.syr.edu/~wedu/seed/labs.html">Seed Labs</a> Copyright © Wenliang Du, Syracuse University. I do not own any software mentioned in the above document.</p></blockquote></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/blog/categories/lab-practice-notes/">Lab Practice Notes</a>, <a href="/blog/categories/seed-labs/">Seed Labs</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/blog/tags/setuid/" class="post-tag no-text-decoration" >setuid</a> <a href="/blog/tags/linux/" class="post-tag no-text-decoration" >linux</a> <a href="/blog/tags/lab/" class="post-tag no-text-decoration" >lab</a> <a href="/blog/tags/seed-labs/" class="post-tag no-text-decoration" >seed-labs</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=SetUID%20Attack%20Lab%20-%20SeedLabs%20-%20Tanishq%20Rupaal&url=https%3A%2F%2Ftanishq.page%2Fblog%2Fposts%2Fsetuid-attack-lab%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=SetUID%20Attack%20Lab%20-%20SeedLabs%20-%20Tanishq%20Rupaal&u=https%3A%2F%2Ftanishq.page%2Fblog%2Fposts%2Fsetuid-attack-lab%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Ftanishq.page%2Fblog%2Fposts%2Fsetuid-attack-lab%2F&text=SetUID%20Attack%20Lab%20-%20SeedLabs%20-%20Tanishq%20Rupaal" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Ftanishq.page%2Fblog%2Fposts%2Fsetuid-attack-lab%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/blog/posts/homelab-npm/">Reverse Proxy in Home Lab</a><li class="text-truncate lh-lg"> <a href="/blog/posts/go-coding/">The Way to Go(lang)</a><li class="text-truncate lh-lg"> <a href="/blog/posts/homelab-budgetlord/">Expense Tracking in Home Lab</a><li class="text-truncate lh-lg"> <a href="/blog/posts/homelab-fusion/">Leantime in Home Lab</a><li class="text-truncate lh-lg"> <a href="/blog/posts/ai-rag/">Exploring RAG (Retrieval-Augmented Generation) and Talking to my Notes</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/blog/tags/home-lab/">home-lab</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/lab/">lab</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/productivity/">productivity</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/offsec-proving-grounds/">offsec-proving-grounds</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/oscp/">oscp</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/aws/">aws</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/container/">container</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/docker/">docker</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/github/">github</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/blog/posts/xss-attack-lab/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1590994800" data-df="ll" > Jun 1, 2020 </time><h4 class="pt-0 my-2">XSS Attack Lab - SeedLabs</h4><div class="text-muted"><p>The tasks are based on a web application called ELGG which is open source. It is designed to be like an open source version of Facebook or myspace. The prebuilt vm called seedubuntu is used to host...</p></div></div></a></article><article class="col"> <a href="/blog/posts/md5-collision-lab/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1590994800" data-df="ll" > Jun 1, 2020 </time><h4 class="pt-0 my-2">MD5 Collision Attack Lab - SeedLabs</h4><div class="text-muted"><p>A hash function is said to be secure if it is a one way hash function and is collision resistant. The one way property ensures that given a hash value h, it is computationally infeasible to find an...</p></div></div></a></article><article class="col"> <a href="/blog/posts/linux-cli-netcat/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1590840000" data-df="ll" > May 30, 2020 </time><h4 class="pt-0 my-2">Basics of Linux Commands and NetCat</h4><div class="text-muted"><p>A shell is an interface to the operating system’s services. All process are created by fork() and given a new direction by the exec() process. The trace of forks and calls can be seen from the stra...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/blog/posts/md5-collision-lab/" class="btn btn-outline-primary" aria-label="Older" ><p>MD5 Collision Attack Lab - SeedLabs</p></a> <a href="/blog/posts/xss-attack-lab/" class="btn btn-outline-primary" aria-label="Newer" ><p>XSS Attack Lab - SeedLabs</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://twitter.com/etheriosking">Tanishq Rupaal</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.2.4" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/blog/tags/home-lab/">home-lab</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/lab/">lab</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/productivity/">productivity</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/offsec-proving-grounds/">offsec-proving-grounds</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/oscp/">oscp</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/aws/">aws</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/container/">container</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/docker/">docker</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/github/">github</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/blog/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
