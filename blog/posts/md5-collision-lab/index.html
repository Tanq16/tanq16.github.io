<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="MD5 Collision Attack Lab - SeedLabs" /><meta property="og:locale" content="en" /><meta name="description" content="A hash function is said to be secure if it is a one way hash function and is collision resistant. The one way property ensures that given a hash value h, it is computationally infeasible to find an input m such that hash(m) = h. The collision resistance property ensures that it is computationally infeasible to find two inputs m and n such that hash(m) = hash(n). The experiment is about actually launching collision attacks on MD5 hash function. A tool called Fast MD5 Collision Generator is used." /><meta property="og:description" content="A hash function is said to be secure if it is a one way hash function and is collision resistant. The one way property ensures that given a hash value h, it is computationally infeasible to find an input m such that hash(m) = h. The collision resistance property ensures that it is computationally infeasible to find two inputs m and n such that hash(m) = hash(n). The experiment is about actually launching collision attacks on MD5 hash function. A tool called Fast MD5 Collision Generator is used." /><link rel="canonical" href="https://tanishq.page/blog/posts/md5-collision-lab/" /><meta property="og:url" content="https://tanishq.page/blog/posts/md5-collision-lab/" /><meta property="og:site_name" content="Tanishq Rupaal" /><meta property="og:image" content="https://tanishq.page/blog/assets/img/covers/seedlabs-cover.jpg" /><meta property="og:image:alt" content="Seed Labs Artwork" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-06-01T03:00:00-04:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://tanishq.page/blog/assets/img/covers/seedlabs-cover.jpg" /><meta name="twitter:image:alt" content="Seed Labs Artwork" /><meta property="twitter:title" content="MD5 Collision Attack Lab - SeedLabs" /><meta name="twitter:site" content="@etheriosking" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2020-06-01T03:00:00-04:00","datePublished":"2020-06-01T03:00:00-04:00","description":"A hash function is said to be secure if it is a one way hash function and is collision resistant. The one way property ensures that given a hash value h, it is computationally infeasible to find an input m such that hash(m) = h. The collision resistance property ensures that it is computationally infeasible to find two inputs m and n such that hash(m) = hash(n). The experiment is about actually launching collision attacks on MD5 hash function. A tool called Fast MD5 Collision Generator is used.","headline":"MD5 Collision Attack Lab - SeedLabs","image":{"alt":"Seed Labs Artwork","url":"https://tanishq.page/blog/assets/img/covers/seedlabs-cover.jpg","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://tanishq.page/blog/posts/md5-collision-lab/"},"url":"https://tanishq.page/blog/posts/md5-collision-lab/"}</script><title>MD5 Collision Attack Lab - SeedLabs | Tanishq Rupaal</title><link rel="apple-touch-icon" sizes="180x180" href="/blog/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/blog/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/blog/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/blog/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/blog/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Tanishq Rupaal"><meta name="application-name" content="Tanishq Rupaal"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/blog/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/blog/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.6.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.29.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return 'mode'; } static get MODE_ATTR() { return 'data-mode'; } static get DARK_MODE() { return 'dark'; } static get LIGHT_MODE() { return 'light'; } static get ID() { return 'mode-toggle'; } constructor() { let self = this;this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { self.clearMode(); } self.notify(); }); if (!this.hasMode) { return; } if (this.isDarkMode) { this.setDark(); } else { this.setLight(); } } get sysDarkPrefers() { return window.matchMedia('(prefers-color-scheme: dark)'); } get isPreferDark() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); }get modeStatus() { if (this.hasMode) { return this.mode; } else { return this.isPreferDark ? ModeToggle.DARK_MODE : ModeToggle.LIGHT_MODE; } } setDark() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { document.documentElement.removeAttribute(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); }notify() { window.postMessage( { direction: ModeToggle.ID, message: this.modeStatus }, '*' ); } flipMode() { if (this.hasMode) { this.clearMode(); } else { if (this.isPreferDark) { this.setLight(); } else { this.setDark(); } } this.notify(); } } const modeToggle = new ModeToggle(); </script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/blog/" id="avatar" class="rounded-circle"><img src="/blog/assets/Abstract.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a><h1 class="site-title"> <a href="/blog/">Tanishq Rupaal</a></h1><p class="site-subtitle fst-italic mb-0">Cybersecurity Professional</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/blog/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/blog/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/blog/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/blog/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/blog/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/tanq16" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/etheriosking" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['dragonking47','proton.me'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://linkedin.com/in/tanishqrupaal" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/blog/">Home</a> </span> <span>MD5 Collision Attack Lab - SeedLabs</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1"><header><h1 data-toc-skip>MD5 Collision Attack Lab - SeedLabs</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1590994800" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jun 1, 2020 </time> </span><div class="mt-3 mb-3"> <a href="/blog/assets/img/covers/seedlabs-cover.jpg" class="popup img-link preview-img shimmer"><img src="/blog/assets/img/covers/seedlabs-cover.jpg" alt="Seed Labs Artwork" width="1200" height="630" loading="lazy"></a><figcaption class="text-center pt-2 pb-2">Seed Labs Artwork</figcaption></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/etheriosking">Tanishq Rupaal</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="1852 words" > <em>10 min</em> read</span></div></div></div></header><div class="content"><p>A hash function is said to be secure if it is a one way hash function and is collision resistant. The one way property ensures that given a hash value <code class="language-plaintext highlighter-rouge">h</code>, it is computationally infeasible to find an input <code class="language-plaintext highlighter-rouge">m</code> such that <code class="language-plaintext highlighter-rouge">hash(m) = h</code>. The collision resistance property ensures that it is computationally infeasible to find two inputs <code class="language-plaintext highlighter-rouge">m</code> and <code class="language-plaintext highlighter-rouge">n</code> such that <code class="language-plaintext highlighter-rouge">hash(m) = hash(n)</code>. The experiment is about actually launching collision attacks on <code class="language-plaintext highlighter-rouge">MD5</code> hash function. A tool called <code class="language-plaintext highlighter-rouge">Fast MD5 Collision Generator</code> is used.</p><h2 id="task-1--generating-two-different-files-with-the-same-md5-hash"><span class="me-2">Task 1 : Generating two different files with the same MD5 hash</span><a href="#task-1--generating-two-different-files-with-the-same-md5-hash" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>To do this, we create two different files with same beginning part or prefix. Then we use the above mentioned tool which allows us to create an arbitrary file, the contents of which will be used as prefix to generate two files <code class="language-plaintext highlighter-rouge">out1.bin</code> and <code class="language-plaintext highlighter-rouge">out2.bin</code> which will have the same MD5 hash. Command is -</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>md5collgen <span class="nt">-p</span> prefix.txt <span class="nt">-o</span> out1.bin out2.bin
</pre></table></code></div></div><p>The tool generates parts P and Q for given prefix text such that <code class="language-plaintext highlighter-rouge">hash(prefix + P) = hash(prefix + Q)</code>. To check if the output files are different and the hash sums are same, we can use commands -</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>diff out1.bin out2.bin
<span class="nb">md5sum </span>out1.bin
<span class="nb">md5sum </span>out2.bin
</pre></table></code></div></div><p>We can use a hex editor (example GHex) to read and modify the binary files. We can use python to pass values inside the prefix file. Let examples be of the form -</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">echo</span> <span class="si">$(</span>python <span class="nt">-c</span> <span class="s1">'print("\x41"*55)'</span><span class="si">)</span> <span class="o">&gt;</span> prefix.txt
</pre></table></code></div></div><p>This will add 55 <code class="language-plaintext highlighter-rouge">A</code>’s to the prefix file. The examples will have 55 replaced with other numbers for different cases.</p><h4 id="prefix-file--64-bytes"><span class="me-2">Prefix file &lt; 64 bytes</span><a href="#prefix-file--64-bytes" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>If the length of the prefix file is not a multiple of 64B, we run the <code class="language-plaintext highlighter-rouge">md5collgen</code> tool to produce the two output files. The files are verified to be different by using <code class="language-plaintext highlighter-rouge">diff</code> command. The files are opened using <code class="language-plaintext highlighter-rouge">GHex</code>. On looking into the hex editor, we see that all bytes the prefix is short of a multiple of 64 are padded with regular expression - <code class="language-plaintext highlighter-rouge">(0A)(00)*</code>.</p><h4 id="prefix-file--64-bytes-1"><span class="me-2">Prefix file = 64 bytes</span><a href="#prefix-file--64-bytes-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>If the length of the prefix file is exactly 64 bytes, the tool still pads the prefix but this time pads the next 64 bytes i.e., from byte offset 40 to 7F. The same is true when the length is a multiple of 64 bytes. Therefore, for length = 64*k, the tool adds a pad of 64 bytes after it.</p><h4 id="difference-between-data"><span class="me-2">Difference between data</span><a href="#difference-between-data" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>The two files generated are very slightly different. Taking the example -</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">echo</span> <span class="si">$(</span>python <span class="nt">-c</span> <span class="s1">'print("\x41"*60)'</span><span class="si">)</span> <span class="o">&gt;</span> prefix.txt
</pre></table></code></div></div><p>This adds 4 bytes of padding and then data that may or may not differ between 2 files. For the above case, the values that were actually different were located at byte offsets 93 and BB.</p><h2 id="task-2--understanding-md5s-property"><span class="me-2">Task 2 : Understanding MD5’s property</span><a href="#task-2--understanding-md5s-property" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>At high level, MD5 divides its data into blocks of 64 bytes and then computes the hash iteratively on these blocks. The core of MD5 is a compression function which produces a 128 bit IHV or intermediate hash value. The input for the first iteration i.e., IHV0 is fixed. Based on the working of the MD5 algorithm, we can derive a property which is - Given two inputs <code class="language-plaintext highlighter-rouge">M</code> and <code class="language-plaintext highlighter-rouge">N</code>, if <code class="language-plaintext highlighter-rouge">MD5(M) = MD5(N)</code>, then for any input <code class="language-plaintext highlighter-rouge">T</code>, <code class="language-plaintext highlighter-rouge">MD5(M || T) = MD5(N || T)</code>. Therefore, adding a particular suffix to any two distinct messages having the same MD5 hash, gives two new longer messages for by concatenation of the original and the suffix messages, both of which also have the same MD5 hash. To demonstrate this, we use the <code class="language-plaintext highlighter-rouge">cat</code> command in <code class="language-plaintext highlighter-rouge">bash</code>, to concatenate the contents of files -</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="nb">cat</span> <span class="o">&gt;</span> prefix
asdfghjkl

md5collgen <span class="nt">-p</span> prefix <span class="nt">-o</span> file1 file2
MD5 collision generator v1.5by Marc Stevens <span class="o">(</span>http://www.win.tue.nl/hashclash/<span class="o">)</span>
Using output filenames: <span class="s1">'file1'</span> and <span class="s1">'file2'</span>
Using prefixfile: <span class="s1">'prefix'</span>
Using initial value: 3c314196e1dd87fadfe827be4e35094c
Generating first block: ..........
Generating second block: S00......
Running <span class="nb">time</span>: 18.89 s
diff file1 file2
Binary files file1 and file2 differ
<span class="nb">cat</span> <span class="o">&gt;</span> suffix
qwerty
l
total 16
<span class="nt">-rw-rw-r--</span> 1 seed seed 192 Mar 16 11:50 file1
<span class="nt">-rw-rw-r--</span> 1 seed seed 192 Mar 16 11:50 file2
<span class="nt">-rw-rw-r--</span> 1 seed seed  10 Mar 16 11:49 prefix
<span class="nt">-rw-rw-r--</span> 1 seed seed   7 Mar 16 11:51 suffix
<span class="nb">md5sum </span>file1
a99e149410559bb7556234176df8cb2c  file1
<span class="nb">md5sum </span>file2
a99e149410559bb7556234176df8cb2c  file2
<span class="nb">cat </span>file1 suffix <span class="o">&gt;</span> modfile1
<span class="nb">cat </span>file2 suffix <span class="o">&gt;</span> modfile2
<span class="nb">md5sum </span>modfile1
c3f590a71d69ad69b0fed60867f05529  modfile1
<span class="nb">md5sum </span>modfile2
c3f590a71d69ad69b0fed60867f05529  modfile2
</pre></table></code></div></div><h2 id="task-3--generating-two-executable-files-with-the-same-md5-hash"><span class="me-2">Task 3 : Generating two executable files with the same MD5 hash</span><a href="#task-3--generating-two-executable-files-with-the-same-md5-hash" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Given a code in C, create two different versions of this code such that the difference in them lies in the array contents, but the hash values of their executables are the same. The code is -</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">xyz</span><span class="p">[</span><span class="mi">200</span><span class="p">]</span> <span class="o">=</span> <span class="p">{};</span> <span class="c1">// populated with self values.</span>
<span class="c1">// let's see how taio reacts to very long lines when they are supposed to be printed on a pdf. This seems to be wrapping text easily, would it be that good&gt;&gt;??? Time to find out.</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">200</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"%x"</span><span class="p">,</span> <span class="n">xyz</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
  <span class="p">}</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Initially, we fill the array contents with just <code class="language-plaintext highlighter-rouge">A</code>’s. This makes it easy to spot the location of the array in the executable after compilation. To print 200 <code class="language-plaintext highlighter-rouge">A</code>’s, we can use python -</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="se">\'</span><span class="sh">'</span><span class="o">+</span><span class="sh">'</span><span class="se">\'</span><span class="s">,</span><span class="se">\'</span><span class="sh">'</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">]</span><span class="o">*</span><span class="mi">200</span><span class="p">)</span><span class="o">+</span><span class="sh">'</span><span class="se">\'</span><span class="sh">'</span><span class="p">)</span>
</pre></table></code></div></div><p>Now to compile and open the executable, we use gcc and then GHex respectively. Spotting the location of a continuous block of <code class="language-plaintext highlighter-rouge">A</code>’s, the byte offset is 1040 (4160). Now the whole executable can be divided into 3 parts - byte offset 0 to x, x to y and y to end. The part y to end will be treated as a suffix. The part 0 to x is treated as prefix. The part x to y is the one where the change is required, or variant, such that - <code class="language-plaintext highlighter-rouge">MD5(prefix || variant1 || suffix) = MD5(prefix || variant2 || suffix)</code>. We keep the prefix little over the byte offset of the first <code class="language-plaintext highlighter-rouge">A</code> as well as a multiple of 64. Therefore, choosing byte offset 4224, everything of the first 4224 bytes is the prefix.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">head</span> <span class="nt">-c</span> 4224 a.out <span class="o">&gt;</span> prefix
</pre></table></code></div></div><p>Using this prefix file for md5collgen, get two files having the same hash called file1 and file 2.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>md5collgen -p prefix -o file1 file2
</pre></table></code></div></div><p>This gives the files with ending byte offset as 10FF. Therefore, we need to keep the bytes after 10FF from the original binary as the suffix.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>tail -c +4352 a.out &gt; suffix
</pre></table></code></div></div><p>Now to create the two binaries, concatenate the suffix to the two individual files.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>cat file1 suffix &gt; code1$ cat file2 suffix &gt; code2
</pre></table></code></div></div><p>These code files can be made executables, which upon execution print different data (one printed 1 byte more than the other in this case). However, the md5sum of both the codes are the same. One way to make sure that the data output by the code files are different is to compute a hash on them. If the hashes are different then the files indeed printed different data.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>echo $(./code1) | md5sumededed2819bd22f8732296e63229ca40  -
echo $(./code2) | md5sumb12e08dfdbd9217653c20c39eb290aba  -
</pre></table></code></div></div><p>This proves that the experiment was successful in creating two different binaries from a single binary, both producing different output but having the same md5 hash.</p><h2 id="task-4--making-two-programs-behave-differently"><span class="me-2">Task 4 : Making two programs behave differently</span><a href="#task-4--making-two-programs-behave-differently" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This task requires us to exploit the hash collision vulnerability. The main idea is to create a program that executes malicious code even after it has been verified as well as checked by hashing it. Therefore, the code needs to have two parts - a malicious and a good part. If the factor that decides whether the good code is executed or the bad one is something that can be exploited, then the attacker can use that to write a code that can pass all verification checks and still manage to run the malicious code. The idea behind the factor is to keep two arrays. If the contents are the same, execute good code, otherwise execute malicious code. Therefore, write a program as follows.</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="cp">#include</span><span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span>
<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">b</span><span class="p">[</span><span class="mi">200</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="o">&lt;</span><span class="n">populate</span><span class="o">&gt;</span><span class="p">};</span>
<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">a</span><span class="p">[</span><span class="mi">200</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="o">&lt;</span><span class="n">populate</span><span class="o">&gt;</span><span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">flag</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
	<span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">200</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="c1">//printf("%c  ", a[i]);</span>
		<span class="k">if</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
		<span class="p">{</span>
			<span class="n">flag</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">if</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">"good code!</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
	<span class="k">else</span>
		<span class="nf">printf</span><span class="p">(</span><span class="s">"bad code!</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>The arrays are populated with <code class="language-plaintext highlighter-rouge">A</code>’s, using python -</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="se">\'</span><span class="sh">'</span><span class="o">+</span><span class="sh">'</span><span class="se">\'</span><span class="s">,</span><span class="se">\'</span><span class="sh">'</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">]</span><span class="o">*</span><span class="mi">200</span><span class="p">)</span><span class="o">+</span><span class="sh">'</span><span class="se">\'</span><span class="sh">'</span><span class="p">)</span>
</pre></table></code></div></div><p>Compile to get an executable, <code class="language-plaintext highlighter-rouge">a.out</code>. All work will be done on this executable. Set the prefix using head command - this includes all the bytes before the start of the first array. Then generate two files using this prefix, which yields <code class="language-plaintext highlighter-rouge">out1</code> and <code class="language-plaintext highlighter-rouge">out2</code> having all except the last 8 elements of the first array. Add all bytes after the 4352nd one in <code class="language-plaintext highlighter-rouge">a.out</code> to <code class="language-plaintext highlighter-rouge">suffixtest</code>.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>head -c 4224 a.out &gt; prefix
md5collgen -p prefix -o out1 out2
tail -c +4353 a.out &gt; suffixtest
</pre></table></code></div></div><p>To complete the first array in the files <code class="language-plaintext highlighter-rouge">out1</code> and <code class="language-plaintext highlighter-rouge">out2</code>, add the first 8 bytes of <code class="language-plaintext highlighter-rouge">suffixtest</code> to both giving files <code class="language-plaintext highlighter-rouge">out1arrcomplete</code> and <code class="language-plaintext highlighter-rouge">out2arrcomplete</code>. Now the <code class="language-plaintext highlighter-rouge">suffix</code> file is created which contains all bytes after the 8th byte in <code class="language-plaintext highlighter-rouge">suffixtest</code>.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>head -c 8 suffixtest &gt; arrcomplete
cat out1 arrcomplete &gt; out1arrcomplete
cat out2 arrcomplete &gt; out2arrcomplete
tail -c +9 suffixtest &gt; suffix
</pre></table></code></div></div><p>Now, to add the bytes between the ending of the first array and the beginning of the second array, make a file called <code class="language-plaintext highlighter-rouge">tillnext</code>. Store the bytes beginning with the second array in <code class="language-plaintext highlighter-rouge">suffix</code> to <code class="language-plaintext highlighter-rouge">suffixtest</code>. Add these bytes to <code class="language-plaintext highlighter-rouge">out1arrcomplete</code> and <code class="language-plaintext highlighter-rouge">out2arrcomplete</code> to give <code class="language-plaintext highlighter-rouge">file1tillnext</code> and <code class="language-plaintext highlighter-rouge">file2tillnext</code>.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>tail -c +25 suffix &gt; suffixtest
head -c 24 suffix &gt; tillnext
cat out1arrcomplete tillnext &gt; file1tillnext
cat out2arrcomplete tillnext &gt; file2tillnext
</pre></table></code></div></div><p>Now the two result files are the two separate part executables which have the contents up to beginning of the second array. To make the attack successful, one file needs to print “good code” while the other “bad code”. To do this the contents of the second array needs to be equal to one of the generated arrays. So, put the bytes after the second array in <code class="language-plaintext highlighter-rouge">suffixtest</code> to <code class="language-plaintext highlighter-rouge">suffix</code>. Then copy the first array from <code class="language-plaintext highlighter-rouge">out1arrcomplete</code> to <code class="language-plaintext highlighter-rouge">comparray</code>. The file <code class="language-plaintext highlighter-rouge">comparray</code> can be appended to <code class="language-plaintext highlighter-rouge">file1tillnext</code> and <code class="language-plaintext highlighter-rouge">file2tillnext</code> along with <code class="language-plaintext highlighter-rouge">suffix</code> to give the final executables <code class="language-plaintext highlighter-rouge">firstexec</code> and <code class="language-plaintext highlighter-rouge">secondexec</code>.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>tail -c +201 suffixtest &gt; suffix
tail -c +4161 out1arrcomplete &gt; comparray
cat file1tillnext comparray suffix &gt; firstexec
cat file2tillnext comparray suffix &gt; secondexec
</pre></table></code></div></div><p>Make these two final files executable and calculate the md5 hash sum. Executing them both gives desired results.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>md5sum firstexec
e68a168be99f12c1bc782b7da5603f62  firstexec
md5sum secondexec
e68a168be99f12c1bc782b7da5603f62  secondexec

chmod +x firstexec
chmod +x secondexec

./firstexec
good code!

./secondexec
bad code!
</pre></table></code></div></div><p>This is how the md5 collision vulnerability can be exploited.</p><hr /><blockquote><p>The above is a documentation of a lab experiment by the name MD5 Collision Attack Lab from publicly available seed labs by Syracuse University. <a href="http://www.cis.syr.edu/~wedu/seed/labs.html">Seed Labs</a> Copyright © Wenliang Du, Syracuse University. I do not own any software mentioned in the above document.</p></blockquote></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/blog/categories/lab-practice-notes/">Lab Practice Notes</a>, <a href="/blog/categories/seed-labs/">Seed Labs</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/blog/tags/md5-collision/" class="post-tag no-text-decoration" >md5-collision</a> <a href="/blog/tags/cryptography/" class="post-tag no-text-decoration" >cryptography</a> <a href="/blog/tags/lab/" class="post-tag no-text-decoration" >lab</a> <a href="/blog/tags/seed-labs/" class="post-tag no-text-decoration" >seed-labs</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=MD5%20Collision%20Attack%20Lab%20-%20SeedLabs%20-%20Tanishq%20Rupaal&url=https%3A%2F%2Ftanishq.page%2Fblog%2Fposts%2Fmd5-collision-lab%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=MD5%20Collision%20Attack%20Lab%20-%20SeedLabs%20-%20Tanishq%20Rupaal&u=https%3A%2F%2Ftanishq.page%2Fblog%2Fposts%2Fmd5-collision-lab%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Ftanishq.page%2Fblog%2Fposts%2Fmd5-collision-lab%2F&text=MD5%20Collision%20Attack%20Lab%20-%20SeedLabs%20-%20Tanishq%20Rupaal" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Ftanishq.page%2Fblog%2Fposts%2Fmd5-collision-lab%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/blog/posts/newbified-effective-notes/">Effective Note-Taking</a><li class="text-truncate lh-lg"> <a href="/blog/posts/homelab-leantime/">Leantime in Home Lab</a><li class="text-truncate lh-lg"> <a href="/blog/posts/gha-docker-arch/">GitHub Actions & ARM Architecture</a><li class="text-truncate lh-lg"> <a href="/blog/posts/dbs-zamasu-timeline/">Dragon Ball Super - Zamasu Timeline 101</a><li class="text-truncate lh-lg"> <a href="/blog/posts/homelab-wallabag/">Wallabag in Home Lab</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/blog/tags/home-lab/">home-lab</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/lab/">lab</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/productivity/">productivity</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/offsec-proving-grounds/">offsec-proving-grounds</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/oscp/">oscp</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/aws/">aws</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/github/">github</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/programming/">programming</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/seed-labs/">seed-labs</a></div></section></div><section id="toc-wrapper" class="d-none ps-0 pe-4"><h2 class="panel-heading ps-3 mb-2">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/blog/posts/xss-attack-lab/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1590994800" data-df="ll" > Jun 1, 2020 </time><h4 class="pt-0 my-2">XSS Attack Lab - SeedLabs</h4><div class="text-muted"><p>The tasks are based on a web application called ELGG which is open source. It is designed to be like an open source version of Facebook or myspace. The prebuilt vm called seedubuntu is used to host...</p></div></div></a></article><article class="col"> <a href="/blog/posts/setuid-attack-lab/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1590994800" data-df="ll" > Jun 1, 2020 </time><h4 class="pt-0 my-2">SetUID Attack Lab - SeedLabs</h4><div class="text-muted"><p>Set-UID is an important security mechanism in unix systems. When a Set-UID program is run, the executing program assumes the owner’s privileges irrespective of the user running the program. The tas...</p></div></div></a></article><article class="col"> <a href="/blog/posts/oscp-pg-set6/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1639897200" data-df="ll" > Dec 19, 2021 </time><h4 class="pt-0 my-2">OffSec PG - Potato, PyExp, Sar, Seppukku</h4><div class="text-muted"><p>Potato Enumeration Machine IP → 192.168.53.101 Network Scan Nmap scan → nmap -A -Pn -p- -T4 -o nmap.txt 192.168.53.101 OS Detection → OS: Linux; CPE: cpe:/o:linux:linux_kernel ...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/blog/posts/linux-cli-netcat/" class="btn btn-outline-primary" aria-label="Older" ><p>Basics of Linux Commands and NetCat</p></a> <a href="/blog/posts/setuid-attack-lab/" class="btn btn-outline-primary" aria-label="Newer" ><p>SetUID Attack Lab - SeedLabs</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2024</time> <a href="https://twitter.com/etheriosking">Tanishq Rupaal</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.1.1" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/blog/tags/home-lab/">home-lab</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/lab/">lab</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/productivity/">productivity</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/offsec-proving-grounds/">offsec-proving-grounds</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/oscp/">oscp</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/aws/">aws</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/github/">github</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/programming/">programming</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/seed-labs/">seed-labs</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.29.0/dist/tocbot.min.js"></script> <script src="/blog/assets/js/dist/post.min.js"></script> <script defer src="/blog/app.min.js?baseurl=/blog&register=true" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-B88HEPZBVJ"></script> <script> document.addEventListener('DOMContentLoaded', function (event) { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-B88HEPZBVJ'); }); </script> <script>SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/blog/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
