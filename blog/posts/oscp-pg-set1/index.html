<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="OffSec PG - BBS Cute, Born2Root, Cybersploit1, Deception" /><meta property="og:locale" content="en" /><meta name="description" content="BBS Cute" /><meta property="og:description" content="BBS Cute" /><link rel="canonical" href="https://tanishq.page/blog/posts/oscp-pg-set1/" /><meta property="og:url" content="https://tanishq.page/blog/posts/oscp-pg-set1/" /><meta property="og:site_name" content="Tanishq Rupaal" /><meta property="og:image" content="https://tanishq.page/blog/assets/img/covers/pg-cover.jpeg" /><meta property="og:image:alt" content="PG Artwork" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-12-19T02:00:00-05:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://tanishq.page/blog/assets/img/covers/pg-cover.jpeg" /><meta name="twitter:image:alt" content="PG Artwork" /><meta property="twitter:title" content="OffSec PG - BBS Cute, Born2Root, Cybersploit1, Deception" /><meta name="twitter:site" content="@etheriosking" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-12-19T02:00:00-05:00","datePublished":"2021-12-19T02:00:00-05:00","description":"BBS Cute","headline":"OffSec PG - BBS Cute, Born2Root, Cybersploit1, Deception","image":{"alt":"PG Artwork","url":"https://tanishq.page/blog/assets/img/covers/pg-cover.jpeg","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://tanishq.page/blog/posts/oscp-pg-set1/"},"url":"https://tanishq.page/blog/posts/oscp-pg-set1/"}</script><title>OffSec PG - BBS Cute, Born2Root, Cybersploit1, Deception | Tanishq Rupaal</title><link rel="apple-touch-icon" sizes="180x180" href="/blog/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/blog/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/blog/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/blog/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/blog/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Tanishq Rupaal"><meta name="application-name" content="Tanishq Rupaal"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/blog/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/blog/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/blog/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script> <script defer src="/blog/assets/js/dist/post.min.js"></script> <script defer src="/blog/app.min.js?baseurl=/blog&register=true" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-B88HEPZBVJ"></script> <script> document.addEventListener('DOMContentLoaded', () => { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-B88HEPZBVJ'); }); </script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/blog/" id="avatar" class="rounded-circle"><img src="/blog/assets/Abstract.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/blog/">Tanishq Rupaal</a><p class="site-subtitle fst-italic mb-0">Cybersecurity Professional</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/blog/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/blog/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/blog/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/blog/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/blog/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/tanq16" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/etheriosking" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['dragonking47','proton.me'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://linkedin.com/in/tanishqrupaal" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/blog/">Home</a> </span> <span>OffSec PG - BBS Cute, Born2Root, Cybersploit1, Deception</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>OffSec PG - BBS Cute, Born2Root, Cybersploit1, Deception</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1639897200" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Dec 19, 2021 </time> </span><div class="mt-3 mb-3"> <a href="/blog/assets/img/covers/pg-cover.jpeg" class="popup img-link preview-img shimmer"><img src="/blog/assets/img/covers/pg-cover.jpeg" alt="PG Artwork" width="1200" height="630" loading="lazy"></a><figcaption class="text-center pt-2 pb-2">PG Artwork</figcaption></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/etheriosking">Tanishq Rupaal</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="1409 words" > <em>7 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">OffSec PG - BBS Cute, Born2Root, Cybersploit1, Deception</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">Contents</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">OffSec PG - BBS Cute, Born2Root, Cybersploit1, Deception</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"><h2 id="bbs-cute"><span class="me-2">BBS Cute</span><a href="#bbs-cute" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="enumeration"><span class="me-2">Enumeration</span><a href="#enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Machine IP → <code class="language-plaintext highlighter-rouge">192.168.192.128</code></p><h4 id="network-scan"><span class="me-2">Network Scan</span><a href="#network-scan" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Nmap scan → <code class="language-plaintext highlighter-rouge">nmap -A -Pn -p- -T4 -o nmap.txt 192.168.192.128</code></p><p>OS Detection → <code class="language-plaintext highlighter-rouge">OS: Linux; CPE: cpe:/o:linux:linux_kernel</code></p><div class="table-wrapper"><table><thead><tr><th><strong>Port</strong><th><strong>Service</strong><th><strong>Other details (if any)</strong><tbody><tr><td>22<td>SSH<td>OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)<tr><td>80<td>HTTP<td>Apache httpd 2.4.38 ((Debian))<tr><td>88<td>KERBEROS-SEC<td>nginx 1.14.2<tr><td>110<td>POP3<td>Courier pop3d<tr><td>995<td>POP3S<td>Courier pop3d</table></div><h4 id="web-scan"><span class="me-2">Web Scan</span><a href="#web-scan" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>GoBuster scan → <code class="language-plaintext highlighter-rouge">gobuster dir -u http://192.168.192.128 -f -w /home/tanq/installations/SecLists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -x html,php,txt</code></p><p>Directories/files listed →</p><ul><li>index.php<li>index.html<li>search.php<li>rss.php<li>icons/ (403)<li>docs/<li>print.php<li>uploads/<li>skins/<li>core/<li>manual/<li>popup.php<li>captcha.php<li>example.php<li>libs/<li>snippet.php<li>show_news.php<li>cdata/<li>server-status</ul><p>The webserver is also running Cute News Management System powered by <code class="language-plaintext highlighter-rouge">CuteNews 2.1.2</code>.</p><h3 id="exploitation"><span class="me-2">Exploitation</span><a href="#exploitation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Using searchsploit to look at existing vulnerabilities, there are 4 results for the version of CuteNews being run on the system. looking at the RCE expoloit, the python code has easy to understand steps.</p><p>Basically, the vulnerability is the ability to upload a reverse shell in place of the avatar for a given user and then navigating to it. The exploit requires various steps. The first is to register a user. This was done at the <code class="language-plaintext highlighter-rouge">/index.php?register</code> page. This required a captcha value, which did not load inline on the page. Without eefort, the <code class="language-plaintext highlighter-rouge">captcha.php</code> file found in directory busting gives the captcha code directly. Therefore, a user was registered.</p><p>Next, the avatar for the user must be updated. This was done by navigating to <code class="language-plaintext highlighter-rouge">/index.php?mod=main&amp;opt=personal</code> page. The php reverse shell from pentest monkey is used as the file for upload here. However, this file is rejected. This implies that the server does check for file names or file headers. By hit and trial, the headers are being checked and not the extensions.</p><p>Therefore, like the exploit-db version of the RCE, the php code must be prepended with the <code class="language-plaintext highlighter-rouge">GIF8;\n</code> header to trick the server to think it is an image file. Also, the <code class="language-plaintext highlighter-rouge">Content-Type</code> header is not checked for file type. The reverse shell uploads successfully and navigating to it at <code class="language-plaintext highlighter-rouge">/uploads/avatar_&lt;username&gt;_php_rev.php</code> executes the php code and gives the reverse shell. The user flag is also obtained via the <code class="language-plaintext highlighter-rouge">www-data</code> permissions.</p><h3 id="privilege-escalation"><span class="me-2">Privilege Escalation</span><a href="#privilege-escalation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Enumerating <code class="language-plaintext highlighter-rouge">sudo -l</code> and setuid files, the interesting option is that of <code class="language-plaintext highlighter-rouge">hping3</code>. Even if the <code class="language-plaintext highlighter-rouge">sudo -l</code> says only <code class="language-plaintext highlighter-rouge">--icmp</code> mode is allowed, since it is a setuid binary, the interface of hping3 can be sirectly exposed. The direct invocation of <code class="language-plaintext highlighter-rouge">hping3</code> allows for a application shell to execute. This does support usual bash commands.</p><p><code class="language-plaintext highlighter-rouge">whoami</code> shows the permissions of <code class="language-plaintext highlighter-rouge">root</code>. Therefore, using the hping3 shell, the root flag can be obtained as well.</p><hr /><h2 id="born2root"><span class="me-2">Born2Root</span><a href="#born2root" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="enumeration-1"><span class="me-2">Enumeration</span><a href="#enumeration-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Machine IP → <code class="language-plaintext highlighter-rouge">192.168.225.49</code></p><h4 id="network-scan-1"><span class="me-2">Network Scan</span><a href="#network-scan-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Nmap scan → <code class="language-plaintext highlighter-rouge">nmap -A -Pn -p- -T4 -o nmap.txt 192.168.225.49</code></p><p>OS Detection → <code class="language-plaintext highlighter-rouge">os_info</code></p><div class="table-wrapper"><table><thead><tr><th><strong>Port</strong><th><strong>Service</strong><th><strong>Other details (if any)</strong><tbody><tr><td>22<td>SSH<td>OpenSSH 6.7p1 Debian 5+deb8u3 (protocol 2.0)<tr><td>80<td>HTTP<td>Apache httpd 2.4.10 ((Debian))<tr><td>111<td>RPCBIND<td>rpcbind 2-4 (RPC #100000)<tr><td>44532<td>-<td>-</table></div><h4 id="web-scan-1"><span class="me-2">Web Scan</span><a href="#web-scan-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>GoBuster scan → <code class="language-plaintext highlighter-rouge">gobuster dir -u http://192.168.225.49 -f -w /home/tanq/installations/SecLists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -x html,php,txt</code></p><p>Robots txt file has two directories →</p><ul><li>wordpress-blog/<li>files/</ul><p>Directories/files listed →</p><ul><li>index.html<li>robots.txt<li>icons/<li>files/<li>manual/</ul><h3 id="exploitation-1"><span class="me-2">Exploitation</span><a href="#exploitation-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The <code class="language-plaintext highlighter-rouge">/icons/</code> directory has a <code class="language-plaintext highlighter-rouge">.txt</code> file which seems out of place amongst all the other image files. Upon inspection, it contained an RSA private key. Used this to login to the ssh server running on the machine. For ther user, the most obvious one is <code class="language-plaintext highlighter-rouge">martin</code> given the clear mentions throughout the website. Upon loggin in, the shell asks for a secret password. Entering something random just drops into the shell and gives the user flag.</p><p>The program that asked for the secret password was located at the end of the <code class="language-plaintext highlighter-rouge">.bashrc</code> in <code class="language-plaintext highlighter-rouge">martin</code>’s home directory. This was <code class="language-plaintext highlighter-rouge">/var/tmp/login.py</code>. Upon close inspection, the script has an error to always allow access into the shell. The script is as follows →</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/python
</span>
<span class="kn">import</span> <span class="n">os</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">""</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">READY TO ACCESS THE SECRET LAB ? </span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">""</span><span class="p">)</span>
<span class="n">password</span> <span class="o">=</span> <span class="nf">raw_input</span><span class="p">(</span><span class="sh">"</span><span class="s">secret password : </span><span class="sh">"</span><span class="p">)</span>

<span class="nf">if </span><span class="p">(</span><span class="n">password</span><span class="p">)</span> <span class="o">==</span> <span class="sh">"</span><span class="s">secretsec</span><span class="sh">"</span> <span class="ow">or</span> <span class="sh">"</span><span class="s">secretlab</span><span class="sh">"</span> <span class="p">:</span> <span class="c1">## --&gt; Always true
</span>	<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">WELCOME ! </span><span class="sh">"</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
	<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">GET OUT ! </span><span class="sh">"</span><span class="p">)</span>
	<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">pkill -u </span><span class="sh">'</span><span class="s">martin</span><span class="sh">'"</span><span class="p">)</span>
</pre></table></code></div></div><h3 id="privilege-escalation-1"><span class="me-2">Privilege Escalation</span><a href="#privilege-escalation-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Looking at the <code class="language-plaintext highlighter-rouge">/etc/passwd</code> file, the users of interest are <code class="language-plaintext highlighter-rouge">root</code>, <code class="language-plaintext highlighter-rouge">martin</code>, <code class="language-plaintext highlighter-rouge">hadi</code> and <code class="language-plaintext highlighter-rouge">jimmy</code>.</p><h4 id="user-1"><span class="me-2">User 1</span><a href="#user-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Looking at the crontab, there is a job by <code class="language-plaintext highlighter-rouge">jimmy</code> that runs every 5 minutes as <code class="language-plaintext highlighter-rouge">python /tmp/sekurity.py</code>. This file does not exist, therefore, can be created and subsequently executed. This can be used to receive a shell as <code class="language-plaintext highlighter-rouge">jimmy</code> over netcat. The home directory consists of a <code class="language-plaintext highlighter-rouge">networker</code> binary, which doesn’t seem to do anything concrete.</p><h4 id="user-2"><span class="me-2">User 2</span><a href="#user-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Cracking the password for <code class="language-plaintext highlighter-rouge">hadi</code> was taking too long, therefore a hack was used to grep out all passwords related to “hadi” from the <code class="language-plaintext highlighter-rouge">rockyou.txt</code> list. This sublist was also set on the cracking task in parallel, which found the password surprisingly quick, resulting in credentials <code class="language-plaintext highlighter-rouge">hadi:hadi123</code>.</p><h4 id="root"><span class="me-2">Root</span><a href="#root" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>As the <code class="language-plaintext highlighter-rouge">hadi</code> user, running <code class="language-plaintext highlighter-rouge">su root</code> directly gives the root shell and thus the root flag.</p><hr /><h2 id="cybersploit1"><span class="me-2">Cybersploit1</span><a href="#cybersploit1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="enumeration-2"><span class="me-2">Enumeration</span><a href="#enumeration-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Machine IP → <code class="language-plaintext highlighter-rouge">192.168.124.92</code></p><h4 id="network-scan-2"><span class="me-2">Network Scan</span><a href="#network-scan-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Nmap scan → <code class="language-plaintext highlighter-rouge">nmap -A -Pn -p- -T4 -o nmap.txt 192.168.124.92</code></p><p>OS Detection → <code class="language-plaintext highlighter-rouge">os_info</code></p><div class="table-wrapper"><table><thead><tr><th><strong>Port</strong><th><strong>Service</strong><th><strong>Other details (if any)</strong><tbody><tr><td>22<td>SSH<td>OpenSSH 5.9p1 Debian 5ubuntu1.10 (Ubuntu Linux; protocol 2.0)<tr><td>80<td>HTTP<td>Apache httpd 2.2.22 ((Ubuntu))</table></div><h4 id="web-scan-2"><span class="me-2">Web Scan</span><a href="#web-scan-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>GoBuster scan → <code class="language-plaintext highlighter-rouge">gobuster dir -u http://192.168.124.92 -w /home/tanq/installations/SecLists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -x html,php</code></p><p>Directories/files listed →</p><ul><li>index/<li>index.html<li>robots/<li>hacker/</ul><p>The <code class="language-plaintext highlighter-rouge">hacker/</code> page consists of a base64 string which decodes to <code class="language-plaintext highlighter-rouge">cybersploit{youtube.com/c/cybersploit}</code>.</p><h3 id="exploitation-2"><span class="me-2">Exploitation</span><a href="#exploitation-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The source of the home page consists of <code class="language-plaintext highlighter-rouge">&lt;!-------------username:itsskv---------------------&gt;</code>. Therefore, this can be used for a password brute force on the ssh server. This did not reveal a password. Testing the previous base64 string as the password works and grants access to the user <code class="language-plaintext highlighter-rouge">itsskv</code>.</p><p>This gives the first flag.</p><h3 id="privilege-escalation-2"><span class="me-2">Privilege Escalation</span><a href="#privilege-escalation-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Enumerating the setuid binaries gives no info. Looking at the kernel version and os version using <code class="language-plaintext highlighter-rouge">uname -a</code>, it seems the kernel is indeed an outdated one → 3.13.0. Using searchsploit to look at exploits for this version using <code class="language-plaintext highlighter-rouge">searchsploit 3.13.0</code>, there is an overlay.fs exploit for local privilege escalation.</p><p>Compiling this binary for the 32 bit version and transferring to the machine via wget, enables getting <code class="language-plaintext highlighter-rouge">root</code> user shell after running it. This gives the root flag.</p><hr /><h2 id="deception"><span class="me-2">Deception</span><a href="#deception" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="enumeration-3"><span class="me-2">Enumeration</span><a href="#enumeration-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Machine IP → <code class="language-plaintext highlighter-rouge">192.168.225.34</code></p><h4 id="network-scan-3"><span class="me-2">Network Scan</span><a href="#network-scan-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Nmap scan → <code class="language-plaintext highlighter-rouge">nmap -A -Pn -p- -T4 -o nmap.txt 192.168.225.34</code></p><p>OS Detection → <code class="language-plaintext highlighter-rouge">OS: Linux; CPE: cpe:/o:linux:linux_kernel</code></p><div class="table-wrapper"><table><thead><tr><th><strong>Port</strong><th><strong>Service</strong><th><strong>Other details (if any)</strong><tbody><tr><td>22<td>SSH<td>OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)<tr><td>80<td>HTTP<td>Apache httpd 2.4.29 ((Ubuntu))</table></div><h4 id="web-scan-3"><span class="me-2">Web Scan</span><a href="#web-scan-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>GoBuster scan → <code class="language-plaintext highlighter-rouge">gobuster dir -u http://192.168.225.34 -f -w /home/tanq/installations/SecLists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -x html,php,txt</code></p><p>Directories/files listed →</p><ul><li>index.html<li>icons/ (403)<li>wordpress/<li>javascript/ (403)<li>phpmyadmin/</ul><p>Scanning the <code class="language-plaintext highlighter-rouge">/wordpress/</code> directory again gives the following →</p><ul><li>index.php (301)<li>wp-content/<li>wp-login.php<li>license.txt<li>wp-includes/<li>readme.html<li>robots.txt<li>robots.html<li>wp-trackback.php<li>wp-admin/ (302)</ul><p>Running WPScan on the target shows the following result →</p><ul><li>XMLRPC enabled at <code class="language-plaintext highlighter-rouge">/wordpress/xmlrpc.php</code><li>Directory listing at <code class="language-plaintext highlighter-rouge">/wordpress/wp-content/uploads/</code><li>WP-Cron enabled at <code class="language-plaintext highlighter-rouge">/wordpress/wp-cron.php</code><li>Wordpress version 5.3.2<li>Enumerated users → <code class="language-plaintext highlighter-rouge">yash</code> and <code class="language-plaintext highlighter-rouge">haclabs</code></ul><h3 id="exploitation-3"><span class="me-2">Exploitation</span><a href="#exploitation-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Looking at the page <code class="language-plaintext highlighter-rouge">/wordpress/robots.html</code>, it has a click interface which shows a playful alert. Looking at the code, a new webpage <code class="language-plaintext highlighter-rouge">/wordpress/admindelete.html</code> was discovered. This page says <code class="language-plaintext highlighter-rouge">LOL,A Noob is looking for a hint</code>. Based on this, searching for <code class="language-plaintext highlighter-rouge">/wordpress/hint.html</code> was discovered, which says <code class="language-plaintext highlighter-rouge">Please collect all the API tokens availabe on the home page</code>. Therefore, the homepage was scoured for API tokens. The following were found →</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>API old0 : 5F4DCC3B5AA
API old1 : 765D61D8
API old2 : 327DEB
API new : 882CF99
</pre></table></code></div></div><p>When concatenated, this gives <code class="language-plaintext highlighter-rouge">5F4DCC3B5AA765D61D8327DEB882CF99</code>. This is not any kind of hash, therefore, trying this out in credentials <code class="language-plaintext highlighter-rouge">yash:5F4DCC3B5AA765D61D8327DEB882CF99</code> works. This gives the shell as user <code class="language-plaintext highlighter-rouge">yash</code> and the local flag.</p><h3 id="privilege-escalation-3"><span class="me-2">Privilege Escalation</span><a href="#privilege-escalation-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="user"><span class="me-2">User</span><a href="#user" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>The uuser <code class="language-plaintext highlighter-rouge">yash</code> is not allowed to run <code class="language-plaintext highlighter-rouge">sudo</code>, therefore, looked at the setuid binaries. The interesting ones were <code class="language-plaintext highlighter-rouge">/usr/bin/arping</code> and <code class="language-plaintext highlighter-rouge">/usr/bin/traceroute6.iputils</code>. Looking at the files in the home directory, there is a file <code class="language-plaintext highlighter-rouge">.systemlogs</code> which contains a bunch of text. This does have the username <code class="language-plaintext highlighter-rouge">haclabs</code> within <code class="language-plaintext highlighter-rouge">""</code>. Grepping out <code class="language-plaintext highlighter-rouge">"</code> to accentuate them shows the following values →</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>haclabs
A=123456789
+A[::-1]
</pre></table></code></div></div><p>The following values make sense from the above → <code class="language-plaintext highlighter-rouge">987654321</code>, <code class="language-plaintext highlighter-rouge">123456789987654321</code> and <code class="language-plaintext highlighter-rouge">haclabs987654321</code>. Trying these out for the user <code class="language-plaintext highlighter-rouge">haclabs</code>, the last one works and grants the shell.</p><h4 id="root-1"><span class="me-2">Root</span><a href="#root-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><code class="language-plaintext highlighter-rouge">haclabs</code> can execute <code class="language-plaintext highlighter-rouge">sudo</code> for all commands without a password. Using this to spawn a shell grants the shell as <code class="language-plaintext highlighter-rouge">root</code> and thus, the root flag.</p><hr /></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/blog/categories/lab-practice-notes/">Lab Practice Notes</a>, <a href="/blog/categories/offsec-proving-grounds/">OffSec Proving Grounds</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/blog/tags/oscp/" class="post-tag no-text-decoration" >oscp</a> <a href="/blog/tags/lab/" class="post-tag no-text-decoration" >lab</a> <a href="/blog/tags/offsec-proving-grounds/" class="post-tag no-text-decoration" >offsec-proving-grounds</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=OffSec%20PG%20-%20BBS%20Cute,%20Born2Root,%20Cybersploit1,%20Deception%20-%20Tanishq%20Rupaal&url=https%3A%2F%2Ftanishq.page%2Fblog%2Fposts%2Foscp-pg-set1%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=OffSec%20PG%20-%20BBS%20Cute,%20Born2Root,%20Cybersploit1,%20Deception%20-%20Tanishq%20Rupaal&u=https%3A%2F%2Ftanishq.page%2Fblog%2Fposts%2Foscp-pg-set1%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Ftanishq.page%2Fblog%2Fposts%2Foscp-pg-set1%2F&text=OffSec%20PG%20-%20BBS%20Cute,%20Born2Root,%20Cybersploit1,%20Deception%20-%20Tanishq%20Rupaal" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Ftanishq.page%2Fblog%2Fposts%2Foscp-pg-set1%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/blog/posts/go-tui/">Building a Terminal UI for Go CLI Tools</a><li class="text-truncate lh-lg"> <a href="/blog/posts/gha-notif/">Custom GitHub WebHook Notifications via GitHub Actions</a><li class="text-truncate lh-lg"> <a href="/blog/posts/homelab-npm/">Reverse Proxy in Home Lab</a><li class="text-truncate lh-lg"> <a href="/blog/posts/go-coding/">The Way to Go(lang)</a><li class="text-truncate lh-lg"> <a href="/blog/posts/homelab-budgetlord/">Expense Tracking in Home Lab</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/blog/tags/home-lab/">home-lab</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/lab/">lab</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/productivity/">productivity</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/offsec-proving-grounds/">offsec-proving-grounds</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/oscp/">oscp</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/aws/">aws</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/container/">container</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/programming/">programming</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/docker/">docker</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/blog/posts/oscp-pg-set6/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1639897200" data-df="ll" > Dec 19, 2021 </time><h4 class="pt-0 my-2">OffSec PG - Potato, PyExp, Sar, Seppukku</h4><div class="text-muted"><p>Potato Enumeration Machine IP → 192.168.53.101 Network Scan Nmap scan → nmap -A -Pn -p- -T4 -o nmap.txt 192.168.53.101 OS Detection → OS: Linux; CPE: cpe:/o:linux:linux_kernel ...</p></div></div></a></article><article class="col"> <a href="/blog/posts/oscp-pg-set5/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1639897200" data-df="ll" > Dec 19, 2021 </time><h4 class="pt-0 my-2">OffSec PG - NoName, SoSimple, OnSystemShellDread, Photographer</h4><div class="text-muted"><p>NoName Enumeration Machine IP → 192.168.225.15 Network Scan Nmap scan → nmap -A -Pn -p- -T4 -o nmap.txt 192.168.225.15 OS Detection → os_info Port Service Other de...</p></div></div></a></article><article class="col"> <a href="/blog/posts/oscp-pg-set4/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1639897200" data-df="ll" > Dec 19, 2021 </time><h4 class="pt-0 my-2">OffSec PG - Katana, Lampiao, Loly, Monitoring</h4><div class="text-muted"><p>Katana Enumeration Machine IP → 192.168.51.83 Network Scan Nmap scan → nmap -A -Pn -p- -T4 -o nmap.txt 192.168.51.83 OS Detection → OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel ...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/blog/posts/open-source-build/" class="btn btn-outline-primary" aria-label="Older" ><p>Introduction to Open Source Projects and CMake</p></a> <a href="/blog/posts/oscp-pg-set2/" class="btn btn-outline-primary" aria-label="Newer" ><p>OffSec PG - FunBox - Easy, Enum, Rookie</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://twitter.com/etheriosking">Tanishq Rupaal</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.2.4" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/blog/tags/home-lab/">home-lab</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/lab/">lab</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/productivity/">productivity</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/offsec-proving-grounds/">offsec-proving-grounds</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/oscp/">oscp</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/aws/">aws</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/container/">container</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/programming/">programming</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/docker/">docker</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/blog/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
